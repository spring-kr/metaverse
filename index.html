<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸŒŒ ë„ê¹¨ë¹„ ë©”íƒ€ë²„ìŠ¤ 3D ì›”ë“œ - ì°¨ì„¸ëŒ€ AI ëŒ€í™” ì‹œìŠ¤í…œ</title>
    
    <!-- Three.js ë° ë¡œë”ë“¤ (ES6 ëª¨ë“ˆ ë°©ì‹ - ê¸°ì¡´ ì‘ë™ ë°©ì‹ ì ìš©) -->
    <script type="importmap">
    {
        "imports": {
            "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
            "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/"
        }
    }
    </script>
    
    <!-- GSAP ì• ë‹ˆë©”ì´ì…˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #000;
            overflow: hidden;
            height: 100vh;
            color: white;
        }
        
        /* ğŸŒŒ ë©”ì¸ ì»¨í…Œì´ë„ˆ */
        .main-container {
            display: flex;
            width: 100vw;
            height: 100vh;
            position: relative;
        }
        
        /* ğŸ® 3D ë©”íƒ€ë²„ìŠ¤ ìº”ë²„ìŠ¤ */
        #metaverse-canvas {
            flex: 1;
            cursor: grab;
            background: linear-gradient(180deg, #000428 0%, #004e92 100%);
        }
        
        #metaverse-canvas:active {
            cursor: grabbing;
        }
        
        /* ğŸ° ì™¼ìª½ ë„ê¹¨ë¹„ ê´€ë¦¬ íŒ¨ë„ */
        .goblin-panel {
            width: 380px;
            background: linear-gradient(135deg, rgba(15, 15, 35, 0.95), rgba(30, 30, 60, 0.9));
            backdrop-filter: blur(20px);
            border-right: 3px solid #4ecdc4;
            padding: 20px;
            overflow-y: auto;
            z-index: 1000;
            box-shadow: 5px 0 30px rgba(78, 205, 196, 0.3);
        }
        
        .panel-title {
            text-align: center;
            font-size: 24px;
            font-weight: bold;
            background: linear-gradient(135deg, #4ecdc4, #44a08d, #96ceb4);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            margin-bottom: 25px;
            text-shadow: 0 0 30px rgba(78, 205, 196, 0.5);
        }
        
        /* ğŸ“Š ì‹œìŠ¤í…œ ìƒíƒœ íŒ¨ë„ */
        .status-panel {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(78, 205, 196, 0.3);
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 20px;
        }
        
        .status-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 14px;
        }
        
        .status-value {
            color: #4ecdc4;
            font-weight: bold;
        }
        
        /* ğŸ‘¹ ë„ê¹¨ë¹„ ì¹´ë“œ ìŠ¤íƒ€ì¼ */
        .goblin-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .goblin-card {
            background: linear-gradient(135deg, rgba(139, 69, 19, 0.8), rgba(160, 82, 45, 0.6));
            border: 2px solid transparent;
            background-clip: padding-box;
            border-radius: 15px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .goblin-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, #4ecdc4, #44a08d);
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: -1;
        }
        
        .goblin-card:hover::before {
            opacity: 0.1;
        }
        
        .goblin-card:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 15px 40px rgba(78, 205, 196, 0.4);
            border-color: #4ecdc4;
        }
        
        .goblin-avatar {
            width: 50px;
            height: 50px;
            margin: 0 auto 10px;
            background: linear-gradient(45deg, #4ecdc4, #44a08d);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            border: 2px solid #d2691e;
            box-shadow: 0 5px 15px rgba(78, 205, 196, 0.3);
        }
        
        .goblin-name {
            font-size: 14px;
            font-weight: bold;
            color: #ffd700;
            margin-bottom: 5px;
        }
        
        .goblin-role {
            font-size: 11px;
            color: #ccc;
            margin-bottom: 8px;
        }
        
        .goblin-status {
            font-size: 10px;
            padding: 3px 8px;
            background: rgba(76, 175, 80, 0.3);
            border-radius: 10px;
            color: #4caf50;
            display: inline-block;
        }
        
        /* ğŸ® ì»¨íŠ¸ë¡¤ ë²„íŠ¼ë“¤ */
        .control-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .control-btn {
            padding: 12px;
            background: linear-gradient(135deg, #4ecdc4, #44a08d);
            border: none;
            border-radius: 10px;
            color: white;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 12px;
        }
        
        .control-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(78, 205, 196, 0.4);
        }
        
        /* ğŸŒŸ ìš°ìƒë‹¨ ì‹œìŠ¤í…œ ì •ë³´ */
        .system-info {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(78, 205, 196, 0.3);
            border-radius: 15px;
            padding: 15px;
            z-index: 1001;
            min-width: 200px;
        }
        
        .system-info h3 {
            color: #4ecdc4;
            margin-bottom: 10px;
            font-size: 16px;
        }
        
        .info-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
            font-size: 12px;
        }
        
        /* ğŸ’¬ ì±„íŒ…ì°½ ì˜¤ë²„ë ˆì´ */
        .chat-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            z-index: 10000;
            display: none;
            align-items: center;
            justify-content: center;
        }
        
        .chat-window {
            width: 90%;
            max-width: 700px;
            max-height: 85vh;
            background: linear-gradient(135deg, rgba(15, 15, 35, 0.95), rgba(30, 30, 60, 0.9));
            border: 2px solid #4ecdc4;
            border-radius: 25px;
            padding: 30px;
            backdrop-filter: blur(25px);
            box-shadow: 0 25px 60px rgba(0, 0, 0, 0.5);
            position: relative;
        }
        
        .chat-header {
            text-align: center;
            margin-bottom: 25px;
            border-bottom: 1px solid rgba(78, 205, 196, 0.3);
            padding-bottom: 20px;
        }
        
        .chat-emoji {
            font-size: 80px;
            display: block;
            margin-bottom: 15px;
            filter: drop-shadow(0 0 20px rgba(78, 205, 196, 0.5));
        }
        
        .chat-title {
            color: #4ecdc4;
            font-size: 24px;
            margin-bottom: 8px;
            font-weight: bold;
        }
        
        .chat-subtitle {
            color: rgba(255, 255, 255, 0.7);
            font-size: 14px;
        }
        
        .chat-messages {
            height: 350px;
            overflow-y: auto;
            border: 1px solid rgba(78, 205, 196, 0.2);
            border-radius: 15px;
            padding: 20px;
            background: rgba(0, 0, 0, 0.3);
            margin-bottom: 20px;
            scrollbar-width: thin;
            scrollbar-color: #4ecdc4 transparent;
        }
        
        .chat-messages::-webkit-scrollbar {
            width: 6px;
        }
        
        .chat-messages::-webkit-scrollbar-track {
            background: transparent;
        }
        
        .chat-messages::-webkit-scrollbar-thumb {
            background: #4ecdc4;
            border-radius: 3px;
        }
        
        .message {
            margin-bottom: 20px;
            animation: fadeInUp 0.3s ease;
        }
        
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .message.user {
            text-align: right;
        }
        
        .message.goblin {
            text-align: left;
        }
        
        .message-bubble {
            display: inline-block;
            padding: 15px 20px;
            border-radius: 20px;
            max-width: 85%;
            word-wrap: break-word;
            font-size: 14px;
            line-height: 1.4;
        }
        
        .message.user .message-bubble {
            background: linear-gradient(135deg, #4ecdc4, #44a08d);
            color: white;
            border-bottom-right-radius: 5px;
        }
        
        .message.goblin .message-bubble {
            background: linear-gradient(135deg, #ff6b6b, #ee5a6f);
            color: white;
            border-bottom-left-radius: 5px;
        }
        
        .chat-input-container {
            display: flex;
            gap: 15px;
            align-items: flex-end;
        }
        
        .chat-input {
            flex: 1;
            padding: 15px;
            border: 1px solid #4ecdc4;
            border-radius: 15px;
            background: rgba(0, 0, 0, 0.5);
            color: white;
            font-size: 14px;
            resize: none;
            min-height: 50px;
            max-height: 120px;
        }
        
        .chat-input:focus {
            outline: none;
            border-color: #ff6b6b;
            box-shadow: 0 0 15px rgba(78, 205, 196, 0.3);
        }
        
        .send-button {
            padding: 15px 25px;
            background: linear-gradient(135deg, #4ecdc4, #44a08d);
            color: white;
            border: none;
            border-radius: 15px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            min-width: 80px;
        }
        
        .send-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(78, 205, 196, 0.4);
        }
        
        .close-button {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: none;
            border-radius: 50%;
            width: 45px;
            height: 45px;
            cursor: pointer;
            font-size: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }
        
        .close-button:hover {
            background: rgba(255, 107, 107, 0.3);
            transform: rotate(90deg);
        }
        
        /* ğŸ“± ë°˜ì‘í˜• ë””ìì¸ */
        @media (max-width: 768px) {
            .goblin-panel {
                width: 100%;
                height: 40vh;
                border-right: none;
                border-bottom: 3px solid #4ecdc4;
            }
            
            .main-container {
                flex-direction: column;
            }
            
            .system-info {
                position: relative;
                top: auto;
                right: auto;
                margin-bottom: 15px;
            }
            
            .goblin-grid {
                grid-template-columns: repeat(3, 1fr);
            }
            
            .chat-window {
                width: 95%;
                padding: 20px;
            }
        }
        
        /* ğŸ¨ ì‹œê°ì  íš¨ê³¼ */
        .loading-spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 2px solid rgba(78, 205, 196, 0.3);
            border-radius: 50%;
            border-top-color: #4ecdc4;
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .pulse {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
    </style>
</head>
<body>
    <div class="main-container">
        <!-- ì™¼ìª½ ë„ê¹¨ë¹„ ê´€ë¦¬ íŒ¨ë„ -->
        <div class="goblin-panel">
            <h1 class="panel-title">ğŸŒŒ ë„ê¹¨ë¹„ ë©”íƒ€ë²„ìŠ¤ 3D</h1>
            
            <!-- ì‹œìŠ¤í…œ ìƒíƒœ -->
            <div class="status-panel">
                <div class="status-item">
                    <span>ğŸ° í™œì„± ë„ê¹¨ë¹„:</span>
                    <span class="status-value" id="activeGoblins">0/16</span>
                </div>
                <div class="status-item">
                    <span>ğŸ’¬ ëŒ€í™” ìˆ˜:</span>
                    <span class="status-value" id="conversationCount">0</span>
                </div>
                <div class="status-item">
                    <span>ğŸŒŸ ì‹œìŠ¤í…œ ìƒíƒœ:</span>
                    <span class="status-value" id="systemStatus">ì´ˆê¸°í™” ì¤‘...</span>
                </div>
            </div>
            
            <!-- ì»¨íŠ¸ë¡¤ ë²„íŠ¼ë“¤ -->
            <div class="control-buttons">
                <button class="control-btn" onclick="spawnAllGoblins()">ğŸš€ ë„ê¹¨ë¹„ ì†Œí™˜</button>
                <button class="control-btn" onclick="resetWorld()">ğŸ”„ ì›”ë“œ ë¦¬ì…‹</button>
                <button class="control-btn" onclick="toggleWeather()">ğŸŒ¦ï¸ ë‚ ì”¨ ë³€ê²½</button>
                <button class="control-btn" onclick="toggleDay()">ğŸŒ… ì‹œê°„ ë³€ê²½</button>
            </div>
            
            <!-- ë„ê¹¨ë¹„ ì¹´ë“œë“¤ -->
            <div class="goblin-grid" id="goblinGrid">
                <!-- JavaScriptë¡œ ë™ì  ìƒì„± -->
            </div>
        </div>
        
        <!-- 3D ë©”íƒ€ë²„ìŠ¤ ìº”ë²„ìŠ¤ -->
        <canvas id="metaverse-canvas"></canvas>
        
        <!-- ìš°ìƒë‹¨ ì‹œìŠ¤í…œ ì •ë³´ -->
        <div class="system-info">
            <h3>ğŸ® ì‹œìŠ¤í…œ ì •ë³´</h3>
            <div class="info-item">
                <span>FPS:</span>
                <span id="fpsCounter">60</span>
            </div>
            <div class="info-item">
                <span>ë©”ëª¨ë¦¬:</span>
                <span id="memoryUsage">0MB</span>
            </div>
            <div class="info-item">
                <span>ë¡œë“œ ìƒíƒœ:</span>
                <span id="loadStatus">ì¤€ë¹„ì¤‘</span>
            </div>
        </div>
    </div>
    
    <!-- ì±„íŒ…ì°½ ì˜¤ë²„ë ˆì´ -->
    <div class="chat-overlay" id="chatOverlay">
        <div class="chat-window">
            <button class="close-button" onclick="closeChat()">Ã—</button>
            
            <div class="chat-header">
                <span class="chat-emoji" id="chatEmoji">ğŸ¥</span>
                <h3 class="chat-title" id="chatTitle">ì˜ë£Œ ì „ë¬¸ê°€</h3>
                <p class="chat-subtitle" id="chatSubtitle">ê±´ê°• ìƒë‹´ ì „ë¬¸</p>
            </div>
            
            <div class="chat-messages" id="chatMessages">
                <!-- ë©”ì‹œì§€ë“¤ì´ ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
            </div>
            
            <div class="chat-input-container">
                <textarea class="chat-input" id="chatInput" 
                         placeholder="ë©”ì‹œì§€ë¥¼ ì…ë ¥í•˜ì„¸ìš”..." 
                         onkeypress="handleKeyPress(event)"></textarea>
                <button class="send-button" onclick="sendMessage()">
                    <span id="sendButtonText">ì „ì†¡</span>
                </button>
            </div>
        </div>
    </div>

    <script type="module">
        // ES6 ëª¨ë“ˆë¡œ Three.js ë° ì»¨íŠ¸ë¡¤ ì„í¬íŠ¸
        import * as THREE from 'three';
        import { OrbitControls } from 'three/addons/controls/OrbitControls.js';

        // Three.js í´ë˜ìŠ¤ë“¤ì„ ì „ì—­ìœ¼ë¡œ í• ë‹¹ (ê¸°ì¡´ ì½”ë“œ í˜¸í™˜ì„±)
        window.THREE = THREE;
        window.OrbitControls = OrbitControls;
        
        console.log('âœ… Three.js ES6 ëª¨ë“ˆ ë¡œë”© ì™„ë£Œ');

        // ğŸŒŒ ê¸€ë¡œë²Œ ë³€ìˆ˜ ë° ì‹œìŠ¤í…œ
        let scene, camera, renderer, controls;
        let goblins3D = [];
        let goblinHouses = [];
        let currentGoblin = null;
        let conversationCount = 0;
        let isSystemReady = false;
        
        // ğŸ“Š ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§
        let frameCount = 0;
        let lastTime = performance.now();
        let fps = 60;
        
        // ğŸ® ê²Œì„ ì‹œìŠ¤í…œ
        let weather = 'sunny';
        let timeOfDay = 'day';
        let particles = [];
        
        // ğŸ‘¹ 16ëª…ì˜ ë„ê¹¨ë¹„ ë°ì´í„° (ê¸°ì¡´ ë²„ì „ê³¼ ì´ë¦„ í†µì¼)
        const goblinDatabase = [
            {
                id: 'medical',
                name: 'ì˜ë£Œ',
                role: 'ê±´ê°• ì •ë³´ ë° ì˜ë£Œ ê°€ì´ë“œ',
                emoji: 'ğŸ¥',
                color: 0x4ecdc4,
                personality: 'professional',
                position: { x: -15, z: -15 },
                specialties: ['ê±´ê°•', 'ì˜í•™', 'ì‘ê¸‰ì²˜ì¹˜', 'ì˜ˆë°©ì˜í•™']
            },
            {
                id: 'builder',
                name: 'ë¹Œë”',
                role: 'ì†Œí”„íŠ¸ì›¨ì–´ ê°œë°œ ë° í”„ë¡œê·¸ë˜ë°',
                emoji: 'ï¿½',
                color: 0x96ceb4,
                personality: 'logical',
                position: { x: -15, z: 15 },
                specialties: ['ê°œë°œ', 'í”„ë¡œê·¸ë˜ë°', 'ê¸°ìˆ ', 'AI']
            },
            {
                id: 'counseling',
                name: 'ìƒë‹´',
                role: 'ì‹¬ë¦¬ ìƒë‹´ ë° ê³ ë¯¼ í•´ê²°',
                emoji: 'ï¿½',
                color: 0xff6b6b,
                personality: 'empathetic',
                position: { x: 15, z: 15 },
                specialties: ['ì‹¬ë¦¬', 'ê°ì •', 'ìƒë‹´', 'ì¹˜ìœ ']
            },
            {
                id: 'creative',
                name: 'ì°½ì‘',
                role: 'ì˜ˆìˆ  ì°½ì‘ ë° ì½˜í…ì¸  ì œì‘',
                emoji: 'ğŸ¨',
                color: 0xfeca57,
                personality: 'creative',
                position: { x: -25, z: 0 },
                specialties: ['ì°½ì˜ì„±', 'ë””ìì¸', 'ì•„ì´ë””ì–´', 'ì˜ˆìˆ ']
            },
            {
                id: 'data-analysis',
                name: 'ë°ì´í„°ë¶„ì„',
                role: 'ë°ì´í„° ê³¼í•™ ë° í†µê³„ ë¶„ì„',
                emoji: 'ğŸ“Š',
                color: 0x9b59b6,
                personality: 'analytical',
                position: { x: 25, z: 0 },
                specialties: ['ë°ì´í„°', 'ë¶„ì„', 'í†µê³„', 'ì¸ì‚¬ì´íŠ¸']
            },
            {
                id: 'seo',
                name: 'SEO',
                role: 'ê²€ìƒ‰ì—”ì§„ ìµœì í™” ë° ì›¹ë§ˆì¼€íŒ…',
                emoji: 'ï¿½',
                color: 0x2ecc71,
                personality: 'strategic',
                position: { x: 0, z: -25 },
                specialties: ['SEO', 'ê²€ìƒ‰ìµœì í™”', 'ì›¹ë§ˆì¼€íŒ…', 'íŠ¸ë˜í”½']
            },
            {
                id: 'marketing',
                name: 'ë§ˆì¼€íŒ…',
                role: 'ë””ì§€í„¸ ë§ˆì¼€íŒ… ë° ë¸Œëœë”©',
                emoji: 'ï¿½',
                color: 0xe74c3c,
                personality: 'energetic',
                position: { x: 10, z: -20 },
                specialties: ['ë§ˆì¼€íŒ…', 'ë¸Œëœë”©', 'í™ë³´', 'ì „ëµ']
            },
            {
                id: 'writing',
                name: 'ê¸€ì“°ê¸°',
                role: 'ë¬¸ì„œ ì‘ì„± ë° ì½˜í…ì¸  ì œì‘',
                emoji: 'âœï¸',
                color: 0x2ecc71,
                personality: 'creative',
                position: { x: 0, z: 25 },
                specialties: ['ê¸€ì“°ê¸°', 'ë¬¸ì„œì‘ì„±', 'ì½˜í…ì¸ ', 'ì°½ì‘']
            },
            {
                id: 'sales',
                name: 'ì»¨ì„¤íŒ…',
                role: 'ì „ëµ ì»¨ì„¤íŒ… ë° ê²½ì˜ ë¶„ì„',
                emoji: 'ğŸ’¼',
                color: 0x45b7d1,
                personality: 'analytical',
                position: { x: 15, z: -15 },
                specialties: ['ì»¨ì„¤íŒ…', 'ê²½ì˜', 'ì „ëµ', 'ë¶„ì„']
            },
            {
                id: 'hr',
                name: 'ì¸ì‚¬',
                role: 'ì¸ì ìì› ê´€ë¦¬ ë° ì¡°ì§ ìš´ì˜',
                emoji: 'ï¿½',
                color: 0x34495e,
                personality: 'supportive',
                position: { x: -10, z: -20 },
                specialties: ['ì¸ì‚¬', 'ì¡°ì§ê´€ë¦¬', 'ì±„ìš©', 'ì¸ì ìì›']
            },
            {
                id: 'assistant',
                name: 'ë¹„ì„œ',
                role: 'ì—…ë¬´ íš¨ìœ¨í™” ë° ì¼ì • ê´€ë¦¬',
                emoji: 'ï¿½',
                color: 0x1abc9c,
                personality: 'efficient',
                position: { x: -20, z: -10 },
                specialties: ['ì—…ë¬´íš¨ìœ¨í™”', 'ì¼ì •ê´€ë¦¬', 'ìë™í™”', 'ë¹„ì„œ']
            },
            {
                id: 'startup',
                name: 'ì°½ì—…',
                role: 'ì°½ì—… ë° ë¹„ì¦ˆë‹ˆìŠ¤ ê°œë°œ',
                emoji: 'ï¿½',
                color: 0x3498db,
                personality: 'innovative',
                position: { x: 20, z: -10 },
                specialties: ['ì°½ì—…', 'ì‚¬ì—…ê³„íš', 'íˆ¬ììœ ì¹˜', 'ë¹„ì¦ˆë‹ˆìŠ¤']
            },
            {
                id: 'shopping',
                name: 'ì‡¼í•‘',
                role: 'ì œí’ˆ ì¶”ì²œ ë° êµ¬ë§¤ ê°€ì´ë“œ',
                emoji: 'ğŸ›ï¸',
                color: 0x9c88ff,
                personality: 'helpful',
                position: { x: -20, z: 10 },
                specialties: ['ì‡¼í•‘', 'ì œí’ˆì¶”ì²œ', 'êµ¬ë§¤ê°€ì´ë“œ', 'ë¦¬ë·°']
            },
            {
                id: 'growth',
                name: 'ì„±ì¥',
                role: 'ê°œì¸ ë°œì „ ë° ìê¸°ê³„ë°œ',
                emoji: 'ï¿½',
                color: 0xff7675,
                personality: 'motivational',
                position: { x: 20, z: 10 },
                specialties: ['ì„±ì¥', 'ìê¸°ê³„ë°œ', 'í•™ìŠµ', 'ë™ê¸°ë¶€ì—¬']
            },
            {
                id: 'fortune',
                name: 'ìš´ì„¸',
                role: 'ì ìˆ  ë° ë¯¸ë˜ ì˜ˆì¸¡',
                emoji: 'ï¿½',
                color: 0xfd79a8,
                personality: 'mystical',
                position: { x: -5, z: 5 },
                specialties: ['ìš´ì„¸', 'ì ìˆ ', 'ë¯¸ë˜ì˜ˆì¸¡', 'ìƒë‹´']
            },
            {
                id: 'village-chief',
                name: 'ì´Œì¥',
                role: 'ë¦¬ë”ì‹­ ë° ì¡°ì§ ê´€ë¦¬',
                emoji: 'ï¿½',
                color: 0xdda0dd,
                personality: 'wise',
                position: { x: 0, z: 0 },
                specialties: ['ë¦¬ë”ì‹­', 'ì¡°ì§ê´€ë¦¬', 'ì¢…í•©ìƒë‹´', 'ì§€í˜œ']
            }
        ];
        
        console.log('ğŸŒŒ 2ë‹¨ê³„: 16ëª… ë„ê¹¨ë¹„ ë°ì´í„° ì‹œìŠ¤í…œ ì™„ë£Œ!');
        
        // ğŸŒŒ 3D ë©”íƒ€ë²„ìŠ¤ í™˜ê²½ ì´ˆê¸°í™”
        function initMetaverse() {
            const canvas = document.getElementById('metaverse-canvas');
            
            // Scene ìƒì„±
            scene = new THREE.Scene();
            scene.fog = new THREE.Fog(0x000428, 50, 200);
            
            // ë™ì  ë°°ê²½ (ì‹œê°„ëŒ€ë³„)
            updateSceneBackground();
            
            // Camera ìƒì„± (ë” ë‹¤ì´ë‚˜ë¯¹í•œ ì„¤ì •)
            camera = new THREE.PerspectiveCamera(75, canvas.offsetWidth / canvas.offsetHeight, 0.1, 1000);
            camera.position.set(0, 15, 30);
            
            // Renderer ìƒì„± (ê³ í’ˆì§ˆ ì„¤ì •)
            renderer = new THREE.WebGLRenderer({ 
                canvas: canvas, 
                antialias: true,
                alpha: true
            });
            renderer.setSize(canvas.offsetWidth, canvas.offsetHeight);
            renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
            renderer.shadowMap.enabled = true;
            renderer.shadowMap.type = THREE.PCFSoftShadowMap;
            renderer.outputEncoding = THREE.sRGBEncoding;
            renderer.toneMapping = THREE.ACESFilmicToneMapping;
            renderer.toneMappingExposure = 1.2;
            
            // Controls ìƒì„± (ë¶€ë“œëŸ¬ìš´ ì¡°ì‘)
            controls = new OrbitControls(camera, renderer.domElement);
            controls.enableDamping = true;
            controls.dampingFactor = 0.05;
            controls.minDistance = 10;
            controls.maxDistance = 100;
            controls.maxPolarAngle = Math.PI / 2.1;
            controls.autoRotate = false;
            controls.autoRotateSpeed = 0.5;
            
            // ê³ ê¸‰ ì¡°ëª… ì‹œìŠ¤í…œ
            setupAdvancedLighting();
            
            // ë©”íƒ€ë²„ìŠ¤ í™˜ê²½ ìƒì„±
            createMetaverseEnvironment();
            
            // 16ê°œ ë„ê¹¨ë¹„ ì§‘ë“¤ ìƒì„±
            createGoblinVillage();
            
            // íŒŒí‹°í´ ì‹œìŠ¤í…œ (ì œê±°ë¨ - ì‹œì•¼ ë°©í•´ë¡œ ì¸í•´)
            // createParticleSystem();
            
            // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
            setupEventListeners();
            
            // ì• ë‹ˆë©”ì´ì…˜ ì‹œì‘
            animate();
            
            // ì‹œìŠ¤í…œ ì¤€ë¹„ ì™„ë£Œ
            isSystemReady = true;
            updateSystemStatus('ì¤€ë¹„ ì™„ë£Œ');
            
            console.log('ğŸŒŒ 3D ë©”íƒ€ë²„ìŠ¤ í™˜ê²½ ì´ˆê¸°í™” ì™„ë£Œ!');
        }
        
        // ï¿½ ì‹œìŠ¤í…œ ìƒíƒœ ì—…ë°ì´íŠ¸
        function updateSystemStatus(status) {
            console.log(`ğŸ® ì‹œìŠ¤í…œ ìƒíƒœ: ${status}`);
            
            // UIì˜ ì‹œìŠ¤í…œ ìƒíƒœ í‘œì‹œ ì—…ë°ì´íŠ¸
            const statusElements = document.querySelectorAll('.system-status');
            statusElements.forEach(element => {
                if (element) {
                    element.innerHTML = `
                        <div>ğŸ® ì‹œìŠ¤í…œ: ${status}</div>
                        <div>ğŸŒ ë©”íƒ€ë²„ìŠ¤: í™œì„±</div>
                        <div>ğŸ‘¹ ë„ê¹¨ë¹„: ${goblins3D.length}/16</div>
                        <div>âš¡ ìƒíƒœ: ì •ìƒ</div>
                    `;
                }
            });
            
            // í™”ë©´ì— ì¼ì‹œì  ì•Œë¦¼ í‘œì‹œ
            updateStatus(`ì‹œìŠ¤í…œ ìƒíƒœ: ${status}`);
        }
        
        // ï¿½ğŸŒ… ë™ì  ë°°ê²½ ì‹œìŠ¤í…œ
        function updateSceneBackground() {
            let skyColor, fogColor;
            
            switch(timeOfDay) {
                case 'dawn':
                    skyColor = new THREE.Color(0x87CEEB);
                    fogColor = 0x87CEEB;
                    break;
                case 'day':
                    skyColor = new THREE.Color(0x87CEFA);
                    fogColor = 0x87CEFA;
                    break;
                case 'sunset':
                    skyColor = new THREE.Color(0xFF6347);
                    fogColor = 0xFF6347;
                    break;
                case 'night':
                    skyColor = new THREE.Color(0x000428);
                    fogColor = 0x000428;
                    break;
                default:
                    skyColor = new THREE.Color(0x000428);
                    fogColor = 0x000428;
            }
            
            scene.background = skyColor;
            scene.fog.color = new THREE.Color(fogColor);
        }
        
        // ğŸ’¡ ê³ ê¸‰ ì¡°ëª… ì‹œìŠ¤í…œ
        function setupAdvancedLighting() {
            // ì£¼ë³€ê´‘
            const ambientLight = new THREE.AmbientLight(0x404040, 0.4);
            scene.add(ambientLight);
            
            // ì£¼ ì¡°ëª… (íƒœì–‘/ë‹¬)
            const mainLight = new THREE.DirectionalLight(
                timeOfDay === 'night' ? 0x4169E1 : 0xffffff, 
                timeOfDay === 'night' ? 0.3 : 0.8
            );
            mainLight.position.set(20, 20, 10);
            mainLight.castShadow = true;
            mainLight.shadow.mapSize.width = 2048;
            mainLight.shadow.mapSize.height = 2048;
            mainLight.shadow.camera.near = 0.1;
            mainLight.shadow.camera.far = 100;
            mainLight.shadow.camera.left = -50;
            mainLight.shadow.camera.right = 50;
            mainLight.shadow.camera.top = 50;
            mainLight.shadow.camera.bottom = -50;
            scene.add(mainLight);
            
            // ë„ê¹¨ë¹„ ì§‘ë“¤ì„ ìœ„í•œ ìƒ‰ìƒ ì¡°ëª…ë“¤
            const lightColors = [0x4ecdc4, 0xff6b6b, 0x45b7d1, 0x96ceb4, 0xfeca57, 0x9b59b6];
            lightColors.forEach((color, index) => {
                const pointLight = new THREE.PointLight(color, 0.6, 30);
                const angle = (index / lightColors.length) * Math.PI * 2;
                pointLight.position.set(
                    Math.cos(angle) * 20,
                    5,
                    Math.sin(angle) * 20
                );
                scene.add(pointLight);
            });
            
            // ì¤‘ì•™ ë§ˆë²• ì¡°ëª…
            const centralLight = new THREE.PointLight(0xffd700, 1, 40);
            centralLight.position.set(0, 10, 0);
            scene.add(centralLight);
        }
        
        // ğŸŒ ë©”íƒ€ë²„ìŠ¤ í™˜ê²½ ìƒì„±
        function createMetaverseEnvironment() {
            // ì§€ë©´ (ë” ìì—°ìŠ¤ëŸ¬ìš´ í…ìŠ¤ì²˜)
            const groundGeometry = new THREE.PlaneGeometry(200, 200);
            const groundMaterial = new THREE.MeshLambertMaterial({ 
                color: 0x2a4d3a,
                transparent: true,
                opacity: 0.8
            });
            const ground = new THREE.Mesh(groundGeometry, groundMaterial);
            ground.rotation.x = -Math.PI / 2;
            ground.receiveShadow = true;
            scene.add(ground);
            
            // í•˜ëŠ˜ì˜ ë³„ë“¤ (ë°¤ì—ë§Œ ë³´ì„)
            createStars();
            
            // ë§ˆë²•ì˜ í¬ë¦¬ìŠ¤í„¸ë“¤
            createMagicCrystals();
            
            // ë°°ê²½ ì‚°ë“¤
            createMountains();
            
            // ì¤‘ì•™ í¬í„¸
            createCentralPortal();
        }
        
        // â­ ë³„ ìƒì„±
        function createStars() {
            const starGeometry = new THREE.BufferGeometry();
            const starCount = 2000;
            const positions = new Float32Array(starCount * 3);
            
            for (let i = 0; i < starCount * 3; i++) {
                positions[i] = (Math.random() - 0.5) * 400;
            }
            
            starGeometry.setAttribute('position', new THREE.BufferAttribute(positions, 3));
            const starMaterial = new THREE.PointsMaterial({ 
                color: 0xffffff,
                size: 1,
                transparent: true,
                opacity: timeOfDay === 'night' ? 0.8 : 0.1
            });
            
            const stars = new THREE.Points(starGeometry, starMaterial);
            scene.add(stars);
        }
        
        // âœ¨ íŒŒí‹°í´ ì‹œìŠ¤í…œ ìƒì„±
        function createParticleSystem() {
            console.log('âœ¨ íŒŒí‹°í´ ì‹œìŠ¤í…œ ìƒì„± ì‹œì‘...');
            
            // ë§ˆë²•ì˜ ë¨¼ì§€ íŒŒí‹°í´
            const particleCount = 500;
            const particleGeometry = new THREE.BufferGeometry();
            const positions = new Float32Array(particleCount * 3);
            const colors = new Float32Array(particleCount * 3);
            const sizes = new Float32Array(particleCount);
            
            for (let i = 0; i < particleCount; i++) {
                // ìœ„ì¹˜ ì„¤ì • (ë„ê¹¨ë¹„ ë§ˆì„ ì£¼ë³€)
                positions[i * 3] = (Math.random() - 0.5) * 80;      // x
                positions[i * 3 + 1] = Math.random() * 20 + 5;     // y (ì§€ë©´ ìœ„)
                positions[i * 3 + 2] = (Math.random() - 0.5) * 80; // z
                
                // ìƒ‰ìƒ ì„¤ì • (ë§ˆë²•ê°™ì€ ìƒ‰ìƒë“¤)
                const magicColors = [
                    [1.0, 0.8, 1.0], // ë¶„í™
                    [0.8, 1.0, 1.0], // í•˜ëŠ˜ìƒ‰
                    [1.0, 1.0, 0.8], // ë…¸ë‘
                    [0.8, 1.0, 0.8], // ì—°ë‘
                    [1.0, 0.9, 0.8]  // ì£¼í™©
                ];
                const colorIndex = Math.floor(Math.random() * magicColors.length);
                colors[i * 3] = magicColors[colorIndex][0];
                colors[i * 3 + 1] = magicColors[colorIndex][1];
                colors[i * 3 + 2] = magicColors[colorIndex][2];
                
                // í¬ê¸° ì„¤ì •
                sizes[i] = Math.random() * 2 + 0.5;
            }
            
            particleGeometry.setAttribute('position', new THREE.BufferAttribute(positions, 3));
            particleGeometry.setAttribute('color', new THREE.BufferAttribute(colors, 3));
            particleGeometry.setAttribute('size', new THREE.BufferAttribute(sizes, 1));
            
            // íŒŒí‹°í´ ë¨¸í‹°ë¦¬ì–¼
            const particleMaterial = new THREE.PointsMaterial({
                size: 2,
                vertexColors: true,
                transparent: true,
                opacity: 0.6,
                blending: THREE.AdditiveBlending,
                sizeAttenuation: true
            });
            
            // íŒŒí‹°í´ ì‹œìŠ¤í…œ ìƒì„±
            const particleSystem = new THREE.Points(particleGeometry, particleMaterial);
            scene.add(particleSystem);
            
            // íŒŒí‹°í´ ì• ë‹ˆë©”ì´ì…˜
            function animateParticles() {
                const positions = particleSystem.geometry.attributes.position.array;
                
                for (let i = 0; i < particleCount; i++) {
                    // ë¶€ë“œëŸ½ê²Œ ë– ë‹¤ë‹ˆëŠ” ì›€ì§ì„
                    positions[i * 3] += Math.sin(Date.now() * 0.001 + i) * 0.01;     // x
                    positions[i * 3 + 1] += Math.cos(Date.now() * 0.0015 + i) * 0.01; // y
                    positions[i * 3 + 2] += Math.sin(Date.now() * 0.0008 + i) * 0.01; // z
                    
                    // ê²½ê³„ ì²´í¬ (íŒŒí‹°í´ì´ ë„ˆë¬´ ë©€ë¦¬ ê°€ì§€ ì•Šë„ë¡)
                    if (Math.abs(positions[i * 3]) > 50) {
                        positions[i * 3] = (Math.random() - 0.5) * 80;
                    }
                    if (positions[i * 3 + 1] > 30 || positions[i * 3 + 1] < 2) {
                        positions[i * 3 + 1] = Math.random() * 20 + 5;
                    }
                    if (Math.abs(positions[i * 3 + 2]) > 50) {
                        positions[i * 3 + 2] = (Math.random() - 0.5) * 80;
                    }
                }
                
                particleSystem.geometry.attributes.position.needsUpdate = true;
            }
            
            // íŒŒí‹°í´ì„ ì „ì—­ ë°°ì—´ì— ì €ì¥í•˜ì—¬ ì• ë‹ˆë©”ì´ì…˜ì—ì„œ ì‚¬ìš©
            particles.push({ system: particleSystem, animate: animateParticles });
            
            console.log('âœ¨ íŒŒí‹°í´ ì‹œìŠ¤í…œ ìƒì„± ì™„ë£Œ');
        }
        
        // ğŸ’ ë§ˆë²•ì˜ í¬ë¦¬ìŠ¤í„¸ë“¤
        function createMagicCrystals() {
            const crystalColors = [0x4ecdc4, 0xff6b6b, 0x45b7d1, 0x96ceb4, 0xfeca57, 0x9b59b6];
            
            for (let i = 0; i < 12; i++) {
                const crystalGeometry = new THREE.ConeGeometry(0.8, 3, 6);
                const crystalMaterial = new THREE.MeshPhongMaterial({ 
                    color: crystalColors[i % crystalColors.length],
                    transparent: true,
                    opacity: 0.7,
                    emissive: crystalColors[i % crystalColors.length],
                    emissiveIntensity: 0.2
                });
                
                const crystal = new THREE.Mesh(crystalGeometry, crystalMaterial);
                crystal.position.set(
                    (Math.random() - 0.5) * 80,
                    1.5,
                    (Math.random() - 0.5) * 80
                );
                crystal.rotation.y = Math.random() * Math.PI * 2;
                crystal.castShadow = true;
                scene.add(crystal);
            }
        }
        
        // ğŸ”ï¸ ë°°ê²½ ì‚°ë“¤
        function createMountains() {
            for (let i = 0; i < 8; i++) {
                const mountainGeometry = new THREE.ConeGeometry(
                    10 + Math.random() * 10, 
                    20 + Math.random() * 15, 
                    8
                );
                const mountainMaterial = new THREE.MeshLambertMaterial({ 
                    color: 0x4a4a4a,
                    transparent: true,
                    opacity: 0.6
                });
                
                const mountain = new THREE.Mesh(mountainGeometry, mountainMaterial);
                const angle = (i / 8) * Math.PI * 2;
                mountain.position.set(
                    Math.cos(angle) * 120,
                    10,
                    Math.sin(angle) * 120
                );
                scene.add(mountain);
            }
        }
        
        // ğŸŒ€ ì¤‘ì•™ í¬í„¸
        function createCentralPortal() {
            const portalGeometry = new THREE.RingGeometry(3, 5, 16);
            const portalMaterial = new THREE.MeshBasicMaterial({ 
                color: 0x4ecdc4,
                transparent: true,
                opacity: 0.5,
                side: THREE.DoubleSide
            });
            
            const portal = new THREE.Mesh(portalGeometry, portalMaterial);
            portal.rotation.x = -Math.PI / 2;
            portal.position.y = 0.1;
            scene.add(portal);
            
            // í¬í„¸ íŒŒí‹°í´ íš¨ê³¼
            const particleCount = 50;
            const particleGeometry = new THREE.BufferGeometry();
            const particlePositions = new Float32Array(particleCount * 3);
            
            for (let i = 0; i < particleCount * 3; i++) {
                particlePositions[i] = (Math.random() - 0.5) * 10;
            }
            
            particleGeometry.setAttribute('position', new THREE.BufferAttribute(particlePositions, 3));
            const particleMaterial = new THREE.PointsMaterial({ 
                color: 0x4ecdc4,
                size: 0.1,
                transparent: true,
                opacity: 0.6
            });
            
            const portalParticles = new THREE.Points(particleGeometry, particleMaterial);
            portalParticles.position.y = 2;
            scene.add(portalParticles);
        }
        
        console.log('ğŸŒŒ 3ë‹¨ê³„: ê³ ê¸‰ 3D í™˜ê²½ êµ¬ì¶• ì™„ë£Œ!');
        
        // ï¿½ ë©”ì¸ ì• ë‹ˆë©”ì´ì…˜ ë£¨í”„
        function animate() {
            requestAnimationFrame(animate);
            
            // í”„ë ˆì„ ì¹´ìš´í„° ì—…ë°ì´íŠ¸
            frameCount++;
            const currentTime = performance.now();
            if (currentTime - lastTime > 1000) {
                fps = frameCount;
                frameCount = 0;
                lastTime = currentTime;
            }
            
            // íŒŒí‹°í´ ì• ë‹ˆë©”ì´ì…˜ ì‹¤í–‰ (ì œê±°ë¨)
            // particles.forEach(particle => {
            //     if (particle.animate) {
            //         particle.animate();
            //     }
            // });
            
            // ì»¨íŠ¸ë¡¤ ì—…ë°ì´íŠ¸
            if (controls) {
                controls.update();
            }
            
            // ë Œë”ë§
            if (renderer && scene && camera) {
                renderer.render(scene, camera);
            }
            
            // ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§ (ê°œë°œ ëª¨ë“œ)
            if (frameCount % 60 === 0) { // 1ì´ˆë§ˆë‹¤
                updatePerformanceInfo();
            }
        }
        
        // ğŸ“Š ì„±ëŠ¥ ì •ë³´ ì—…ë°ì´íŠ¸
        function updatePerformanceInfo() {
            const memoryInfo = performance.memory ? {
                used: Math.round(performance.memory.usedJSHeapSize / 1048576),
                total: Math.round(performance.memory.totalJSHeapSize / 1048576),
                limit: Math.round(performance.memory.jsHeapSizeLimit / 1048576)
            } : null;
            
            // ì„±ëŠ¥ ì •ë³´ë¥¼ ì½˜ì†”ì— ì¶œë ¥ (ë””ë²„ê¹…ìš©)
            if (frameCount === 0) { // 1ì´ˆë§ˆë‹¤ í•œ ë²ˆë§Œ
                console.log(`ğŸ“Š FPS: ${fps}, ë„ê¹¨ë¹„: ${goblins3D.length}/16${memoryInfo ? `, ë©”ëª¨ë¦¬: ${memoryInfo.used}MB` : ''}`);
            }
        }
        
        // ï¿½ğŸ° 16ê°œ ë„ê¹¨ë¹„ ë§ˆì„ ìƒì„±
        function createGoblinVillage() {
            goblinDatabase.forEach((goblinData, index) => {
                // ë„ê¹¨ë¹„ ì§‘ ìƒì„±
                const house = createGoblinHouse(goblinData, index);
                goblinHouses.push(house);
                scene.add(house);
                
                // 3D ë„ê¹¨ë¹„ ìºë¦­í„° ìƒì„±
                const goblin3D = create3DGoblin(goblinData, index);
                goblins3D.push(goblin3D);
                scene.add(goblin3D);
            });
            
            // UI ë„ê¹¨ë¹„ ì¹´ë“œë“¤ ìƒì„±
            createGoblinUI();
            
            updateActiveGoblins();
        }
        
        // ğŸ”„ í™œì„± ë„ê¹¨ë¹„ ìƒíƒœ ì—…ë°ì´íŠ¸
        function updateActiveGoblins() {
            // í™œì„± ë„ê¹¨ë¹„ ì¹´ìš´íŠ¸ ì—…ë°ì´íŠ¸
            const activeCount = goblins3D.length;
            
            // UIì—ì„œ í™œì„± ë„ê¹¨ë¹„ í‘œì‹œ ì—…ë°ì´íŠ¸
            const statusElement = document.querySelector('.system-status');
            if (statusElement) {
                statusElement.innerHTML = `
                    <div>ğŸ® í™œì„± ë„ê¹¨ë¹„: ${activeCount}/16</div>
                    <div>ğŸŒ ë©”íƒ€ë²„ìŠ¤ ìƒíƒœ: í™œì„±</div>
                    <div>âš¡ ì‹œìŠ¤í…œ: ì •ìƒ</div>
                `;
            }
            
            // ë„ê¹¨ë¹„ë“¤ì˜ AI í–‰ë™ ì‹œì‘
            goblins3D.forEach((goblin3D, index) => {
                if (goblin3D && goblin3D.userData) {
                    startGoblinAI(goblin3D, goblinDatabase[index]);
                }
            });
            
            console.log(`âœ… ${activeCount}ëª…ì˜ ë„ê¹¨ë¹„ í™œì„±í™” ì™„ë£Œ`);
        }
        
        // ğŸ  ê°œë³„ ë„ê¹¨ë¹„ ì§‘ ìƒì„±
        function createGoblinHouse(goblinData, index) {
            const houseGroup = new THREE.Group();
            
            // ì§‘ ê¸°ì´ˆ
            const foundationGeometry = new THREE.BoxGeometry(4, 0.5, 4);
            const foundationMaterial = new THREE.MeshPhongMaterial({ color: 0x8b4513 });
            const foundation = new THREE.Mesh(foundationGeometry, foundationMaterial);
            foundation.position.y = 0.25;
            foundation.castShadow = true;
            foundation.receiveShadow = true;
            houseGroup.add(foundation);
            
            // ì§‘ ë²½
            const wallGeometry = new THREE.BoxGeometry(3.5, 3, 3.5);
            const wallMaterial = new THREE.MeshPhongMaterial({ 
                color: goblinData.color,
                transparent: true,
                opacity: 0.9
            });
            const walls = new THREE.Mesh(wallGeometry, wallMaterial);
            walls.position.y = 2;
            walls.castShadow = true;
            walls.receiveShadow = true;
            houseGroup.add(walls);
            
            // ì§€ë¶•
            const roofGeometry = new THREE.ConeGeometry(3, 2.5, 8);
            const roofMaterial = new THREE.MeshPhongMaterial({ color: 0x654321 });
            const roof = new THREE.Mesh(roofGeometry, roofMaterial);
            roof.position.y = 4.75;
            roof.castShadow = true;
            houseGroup.add(roof);
            
            // ë¬¸
            const doorGeometry = new THREE.BoxGeometry(0.8, 2, 0.1);
            const doorMaterial = new THREE.MeshPhongMaterial({ color: 0x4a4a4a });
            const door = new THREE.Mesh(doorGeometry, doorMaterial);
            door.position.set(0, 1.5, 1.76);
            houseGroup.add(door);
            
            // ì°½ë¬¸ë“¤
            for (let i = 0; i < 2; i++) {
                const windowGeometry = new THREE.BoxGeometry(0.6, 0.6, 0.1);
                const windowMaterial = new THREE.MeshPhongMaterial({ 
                    color: 0x87CEEB,
                    transparent: true,
                    opacity: 0.7
                });
                const window = new THREE.Mesh(windowGeometry, windowMaterial);
                window.position.set((i === 0 ? -1 : 1), 2.5, 1.76);
                houseGroup.add(window);
            }
            
            // êµ´ëš
            const chimneyGeometry = new THREE.BoxGeometry(0.4, 1.5, 0.4);
            const chimneyMaterial = new THREE.MeshPhongMaterial({ color: 0x8b4513 });
            const chimney = new THREE.Mesh(chimneyGeometry, chimneyMaterial);
            chimney.position.set(1.2, 5.75, 1.2);
            chimney.castShadow = true;
            houseGroup.add(chimney);
            
            // ì—°ê¸° íŒŒí‹°í´ (êµ´ëšìš©)
            if (Math.random() > 0.5) {
                const smokeParticles = createSmokeEffect();
                smokeParticles.position.set(1.2, 6.5, 1.2);
                houseGroup.add(smokeParticles);
            }
            
            // ì§‘ ì• ì¥ì‹
            const decorationGeometry = new THREE.SphereGeometry(0.3, 8, 8);
            const decorationMaterial = new THREE.MeshPhongMaterial({ 
                color: goblinData.color,
                emissive: goblinData.color,
                emissiveIntensity: 0.3
            });
            const decoration = new THREE.Mesh(decorationGeometry, decorationMaterial);
            decoration.position.set(0, 1, 2.5);
            decoration.castShadow = true;
            houseGroup.add(decoration);
            
            // ì§‘ ìœ„ì¹˜ ì„¤ì •
            houseGroup.position.set(goblinData.position.x, 0, goblinData.position.z);
            houseGroup.userData = { goblinData: goblinData, type: 'house' };
            
            return houseGroup;
        }
        
        // ğŸ§™â€â™‚ï¸ 3D ë„ê¹¨ë¹„ ìºë¦­í„° ìƒì„±
        function create3DGoblin(goblinData, index) {
            const goblinGroup = new THREE.Group();
            
            // ë„ê¹¨ë¹„ ëª¸ì²´ (êµ¬)
            const bodyGeometry = new THREE.SphereGeometry(0.8, 16, 16);
            const bodyMaterial = new THREE.MeshPhongMaterial({ 
                color: goblinData.color,
                shininess: 30
            });
            const body = new THREE.Mesh(bodyGeometry, bodyMaterial);
            body.position.y = 0.8;
            body.castShadow = true;
            goblinGroup.add(body);
            
            // ë„ê¹¨ë¹„ ë¨¸ë¦¬ (ë” í° êµ¬)
            const headGeometry = new THREE.SphereGeometry(0.6, 16, 16);
            const baseColor = new THREE.Color(goblinData.color);
            // ì•ˆì •ì ì¸ ìƒ‰ìƒ ì¡°ì •
            const headColor = baseColor.clone().multiplyScalar(1.2);
            const headMaterial = new THREE.MeshPhongMaterial({ 
                color: headColor
            });
            const head = new THREE.Mesh(headGeometry, headMaterial);
            head.position.y = 2;
            head.castShadow = true;
            goblinGroup.add(head);
            
            // ëˆˆë“¤
            for (let i = 0; i < 2; i++) {
                const eyeGeometry = new THREE.SphereGeometry(0.1, 8, 8);
                const eyeMaterial = new THREE.MeshPhongMaterial({ color: 0xffffff });
                const eye = new THREE.Mesh(eyeGeometry, eyeMaterial);
                eye.position.set((i === 0 ? -0.2 : 0.2), 2.2, 0.5);
                goblinGroup.add(eye);
                
                // ëˆˆë™ì
                const pupilGeometry = new THREE.SphereGeometry(0.05, 8, 8);
                const pupilMaterial = new THREE.MeshPhongMaterial({ color: 0x000000 });
                const pupil = new THREE.Mesh(pupilGeometry, pupilMaterial);
                pupil.position.set((i === 0 ? -0.2 : 0.2), 2.2, 0.55);
                goblinGroup.add(pupil);
            }
            
            // ëª¨ì (ì›ë¿”)
            const hatGeometry = new THREE.ConeGeometry(0.5, 1.2, 8);
            const hatMaterial = new THREE.MeshPhongMaterial({ color: 0x4a4a4a });
            const hat = new THREE.Mesh(hatGeometry, hatMaterial);
            hat.position.y = 2.8;
            hat.castShadow = true;
            goblinGroup.add(hat);
            
            // íŒ”ë“¤
            for (let i = 0; i < 2; i++) {
                // ì•ˆì •ì ì¸ CylinderGeometry ì‚¬ìš©
                const armGeometry = new THREE.CylinderGeometry(0.15, 0.15, 0.8, 8);
                const baseColor = new THREE.Color(goblinData.color);
                // ìƒ‰ìƒ ì¡°ì • (multiplyScalar ì‚¬ìš©)
                const armColor = baseColor.clone().multiplyScalar(1.1);
                const armMaterial = new THREE.MeshPhongMaterial({ 
                    color: armColor
                });
                const arm = new THREE.Mesh(armGeometry, armMaterial);
                arm.position.set((i === 0 ? -1 : 1), 1.2, 0);
                arm.rotation.z = (i === 0 ? 0.3 : -0.3);
                arm.castShadow = true;
                goblinGroup.add(arm);
            }
            
            // ë‹¤ë¦¬ë“¤
            for (let i = 0; i < 2; i++) {
                // ì•ˆì •ì ì¸ CylinderGeometry ì‚¬ìš©
                const legGeometry = new THREE.CylinderGeometry(0.2, 0.2, 0.6, 8);
                const baseColor = new THREE.Color(goblinData.color);
                // ìƒ‰ìƒ ì¡°ì • (multiplyScalar ì‚¬ìš©)
                const legColor = baseColor.clone().multiplyScalar(0.9);
                const legMaterial = new THREE.MeshPhongMaterial({ 
                    color: legColor
                });
                const leg = new THREE.Mesh(legGeometry, legMaterial);
                leg.position.set((i === 0 ? -0.3 : 0.3), 0.3, 0);
                leg.castShadow = true;
                goblinGroup.add(leg);
            }
            
            // ë§ˆë²• ì˜¤ë¼ íš¨ê³¼
            const auraGeometry = new THREE.RingGeometry(1.5, 2, 16);
            const auraMaterial = new THREE.MeshBasicMaterial({ 
                color: goblinData.color,
                transparent: true,
                opacity: 0.2,
                side: THREE.DoubleSide
            });
            const aura = new THREE.Mesh(auraGeometry, auraMaterial);
            aura.rotation.x = -Math.PI / 2;
            aura.position.y = 0.1;
            goblinGroup.add(aura);
            
            // ë„ê¹¨ë¹„ ìœ„ì¹˜ ì„¤ì • (ì§‘ ì•)
            goblinGroup.position.set(
                goblinData.position.x + (Math.random() - 0.5) * 2,
                0,
                goblinData.position.z + 3
            );
            
            goblinGroup.userData = { 
                goblinData: goblinData, 
                type: 'goblin',
                animationOffset: Math.random() * Math.PI * 2
            };
            
            return goblinGroup;
        }
        
        // ğŸ’¨ ì—°ê¸° íš¨ê³¼ ìƒì„±
        function createSmokeEffect() {
            const smokeGeometry = new THREE.BufferGeometry();
            const smokeCount = 20;
            const positions = new Float32Array(smokeCount * 3);
            
            for (let i = 0; i < smokeCount; i++) {
                positions[i * 3] = (Math.random() - 0.5) * 0.5;
                positions[i * 3 + 1] = Math.random() * 2;
                positions[i * 3 + 2] = (Math.random() - 0.5) * 0.5;
            }
            
            smokeGeometry.setAttribute('position', new THREE.BufferAttribute(positions, 3));
            const smokeMaterial = new THREE.PointsMaterial({ 
                color: 0x888888,
                size: 0.3,
                transparent: true,
                opacity: 0.5
            });
            
            return new THREE.Points(smokeGeometry, smokeMaterial);
        }
        
        // ğŸ¨ UI ë„ê¹¨ë¹„ ì¹´ë“œë“¤ ìƒì„±
        function createGoblinUI() {
            const goblinGrid = document.getElementById('goblinGrid');
            goblinGrid.innerHTML = '';
            
            goblinDatabase.forEach((goblin, index) => {
                const card = document.createElement('div');
                card.className = 'goblin-card';
                card.onclick = () => focusOnGoblin(index);
                
                card.innerHTML = `
                    <div class="goblin-avatar">${goblin.emoji}</div>
                    <div class="goblin-name">${goblin.name}</div>
                    <div class="goblin-role">${goblin.role}</div>
                    <div class="goblin-status">ğŸ’š í™œì„±</div>
                `;
                
                goblinGrid.appendChild(card);
            });
        }
        
        console.log('ğŸŒŒ 4ë‹¨ê³„: 16ê°œ ë„ê¹¨ë¹„ ì§‘ê³¼ ìºë¦­í„° ìƒì„± ì™„ë£Œ!');
        
        // ğŸ® ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì •
        function setupEventListeners() {
            const canvas = document.getElementById('metaverse-canvas');
            
            // í´ë¦­ ì´ë²¤íŠ¸ (ë„ê¹¨ë¹„ ì„ íƒ)
            canvas.addEventListener('click', onCanvasClick);
            
            // í‚¤ë³´ë“œ ì´ë²¤íŠ¸
            document.addEventListener('keydown', onKeyDown);
            
            // ìœˆë„ìš° ë¦¬ì‚¬ì´ì¦ˆ
            window.addEventListener('resize', onWindowResize);
        }
        
        // ğŸ–±ï¸ ìº”ë²„ìŠ¤ í´ë¦­ ì²˜ë¦¬
        function onCanvasClick(event) {
            if (!camera || !goblins3D || goblins3D.length === 0) return; // ì•ˆì „ì¥ì¹˜
            
            const mouse = new THREE.Vector2();
            mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
            mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;
            
            const raycaster = new THREE.Raycaster();
            raycaster.setFromCamera(mouse, camera);
            
            // ë„ê¹¨ë¹„ë“¤ê³¼ì˜ êµì°¨ ê²€ì‚¬
            const goblinMeshes = goblins3D.flatMap(group => group.children);
            const intersects = raycaster.intersectObjects(goblinMeshes);
            
            if (intersects.length > 0) {
                const clickedObject = intersects[0].object.parent;
                const goblinData = clickedObject.userData.goblinData;
                
                if (goblinData) {
                    selectGoblin(goblinData);
                    openChat(goblinData);
                }
            }
        }
        
        // âŒ¨ï¸ í‚¤ë³´ë“œ ì´ë²¤íŠ¸ ì²˜ë¦¬
        function onKeyDown(event) {
            switch(event.key) {
                case 'Escape':
                    closeChat();
                    break;
                case ' ':
                    toggleAutoRotate();
                    event.preventDefault();
                    break;
                case 't':
                case 'T':
                    toggleDay();
                    break;
                case 'w':
                case 'W':
                    toggleWeather();
                    break;
                case 'r':
                case 'R':
                    resetCamera();
                    break;
            }
        }
        
        // ğŸ“± ìœˆë„ìš° ë¦¬ì‚¬ì´ì¦ˆ ì²˜ë¦¬
        function onWindowResize() {
            if (!camera || !renderer) return; // ì•ˆì „ì¥ì¹˜
            
            const canvas = document.getElementById('metaverse-canvas');
            if (!canvas) return; // ìº”ë²„ìŠ¤ í™•ì¸
            
            camera.aspect = canvas.offsetWidth / canvas.offsetHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(canvas.offsetWidth, canvas.offsetHeight);
        }
        
        // ğŸ¯ ë„ê¹¨ë¹„ ì„ íƒ ë° í¬ì»¤ìŠ¤
        function selectGoblin(goblinData) {
            const goblinIndex = goblinDatabase.findIndex(g => g.id === goblinData.id);
            const goblin3D = goblins3D[goblinIndex];
            
            if (goblin3D) {
                // ë„ê¹¨ë¹„ í•˜ì´ë¼ì´íŠ¸ ì• ë‹ˆë©”ì´ì…˜
                gsap.to(goblin3D.scale, {
                    x: 1.2, y: 1.2, z: 1.2,
                    duration: 0.3,
                    yoyo: true,
                    repeat: 1,
                    ease: "power2.inOut"
                });
                
                // ì¹´ë©”ë¼ë¥¼ ë„ê¹¨ë¹„ì—ê²Œ í¬ì»¤ìŠ¤
                focusOnGoblin(goblinIndex);
            }
        }
        
        // ğŸ“· ë„ê¹¨ë¹„ì—ê²Œ ì¹´ë©”ë¼ í¬ì»¤ìŠ¤
        function focusOnGoblin(index) {
            const goblin = goblins3D[index];
            if (goblin) {
                const targetPosition = {
                    x: goblin.position.x + 5,
                    y: goblin.position.y + 3,
                    z: goblin.position.z + 5
                };
                
                gsap.to(camera.position, {
                    ...targetPosition,
                    duration: 1.5,
                    ease: "power2.inOut"
                });
                
                gsap.to(controls.target, {
                    x: goblin.position.x,
                    y: goblin.position.y + 1,
                    z: goblin.position.z,
                    duration: 1.5,
                    ease: "power2.inOut",
                    onUpdate: () => controls.update()
                });
            }
        }
        
        // ğŸ’¬ ì±„íŒ…ì°½ ì—´ê¸°
        function openChat(goblinData) {
            currentGoblin = goblinData;
            
            document.getElementById('chatEmoji').textContent = goblinData.emoji;
            document.getElementById('chatTitle').textContent = goblinData.name;
            document.getElementById('chatSubtitle').textContent = goblinData.role;
            
            // ì´ˆê¸° ë©”ì‹œì§€
            const messagesContainer = document.getElementById('chatMessages');
            messagesContainer.innerHTML = `
                <div class="message goblin">
                    <div class="message-bubble">
                        ì•ˆë…•í•˜ì„¸ìš”! ${goblinData.name}ì…ë‹ˆë‹¤. ${goblinData.specialties.join(', ')} ë¶„ì•¼ì˜ ì „ë¬¸ê°€ì˜ˆìš”. 
                        ë¬´ì—‡ì„ ë„ì™€ë“œë¦´ê¹Œìš”? ğŸ˜Š
                    </div>
                </div>
            `;
            
            document.getElementById('chatOverlay').style.display = 'flex';
            document.getElementById('chatInput').focus();
            
            conversationCount++;
            updateConversationCount();
        }
        
        // ğŸ’¬ ì±„íŒ…ì°½ ë‹«ê¸°
        function closeChat() {
            document.getElementById('chatOverlay').style.display = 'none';
            currentGoblin = null;
        }
        
        // âŒ¨ï¸ ì±„íŒ… ì…ë ¥ ì²˜ë¦¬
        function handleKeyPress(event) {
            if (event.key === 'Enter' && !event.shiftKey) {
                event.preventDefault();
                sendMessage();
            }
        }
        
        // ğŸ“¤ ë©”ì‹œì§€ ì „ì†¡
        function sendMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            
            if (!message || !currentGoblin) return;
            
            // ì‚¬ìš©ì ë©”ì‹œì§€ ì¶”ê°€
            addMessage('user', message);
            
            // ì „ì†¡ ë²„íŠ¼ ë¡œë”© ìƒíƒœ
            const sendButton = document.getElementById('sendButtonText');
            sendButton.innerHTML = '<div class="loading-spinner"></div>';
            
            // AI ì‘ë‹µ ìƒì„± (1-2ì´ˆ ì§€ì—°ìœ¼ë¡œ í˜„ì‹¤ì ì¸ ëŒ€í™”ê°)
            setTimeout(() => {
                const response = generateAdvancedAIResponse(currentGoblin, message);
                addMessage('goblin', response);
                sendButton.textContent = 'ì „ì†¡';
            }, 1000 + Math.random() * 1000);
            
            input.value = '';
        }
        
        // ğŸ’¬ ë©”ì‹œì§€ ì¶”ê°€
        function addMessage(sender, text) {
            const messagesContainer = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${sender}`;
            messageDiv.innerHTML = `<div class="message-bubble">${text}</div>`;
            messagesContainer.appendChild(messageDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }
        
        // ğŸ¤– ê³ ê¸‰ AI ì‘ë‹µ ìƒì„± (ê¸°ì¡´ ë„ê¹¨ë¹„ë“¤ê³¼ ë§¤ì¹­)
        function generateAdvancedAIResponse(goblinData, input) {
            const userInput = input.toLowerCase();
            const specialties = goblinData.specialties;
            const goblinName = goblinData.name;
            
            // ë„ê¹¨ë¹„ ì´ë¦„ ê¸°ë°˜ ì‘ë‹µ ë¶„ê¸°
            switch(goblinName) {
                case 'ì˜ë£Œ':
                    return generateMedicalResponse(input);
                case 'ë¹Œë”':
                    return generateTechResponse(input);
                case 'ìƒë‹´':
                    return generatePsychologyResponse(input);
                case 'ì°½ì‘':
                    return generateCreativeResponse(input);
                case 'ë°ì´í„°ë¶„ì„':
                    return generateDataResponse(input);
                case 'SEO':
                    return generateSEOResponse(input);
                case 'ë§ˆì¼€íŒ…':
                    return generateMarketingResponse(input);
                case 'ê¸€ì“°ê¸°':
                    return generateWritingResponse(input);
                case 'ì»¨ì„¤íŒ…':
                    return generateBusinessResponse(input);
                case 'ì¸ì‚¬':
                    return generateHRResponse(input);
                case 'ë¹„ì„œ':
                    return generateAssistantResponse(input);
                case 'ì°½ì—…':
                    return generateStartupResponse(input);
                case 'ì‡¼í•‘':
                    return generateShoppingResponse(input);
                case 'ì„±ì¥':
                    return generateGrowthResponse(input);
                case 'ìš´ì„¸':
                    return generateFortuneResponse(input);
                case 'ì´Œì¥':
                    return generateWiseResponse(input);
                default:
                    return generateWiseResponse(input);
            }
        }
        
        // ğŸ¥ ì˜ë£Œ ì‘ë‹µ
        function generateMedicalResponse(input) {
            return `ğŸ¥ **ì˜ë£Œ ì „ë¬¸ ë¶„ì„**

**ğŸ” ì¦ìƒ ê²€í† **: "${input}"

**ğŸ“‹ ì „ë¬¸ ì¡°ì¹˜ì‚¬í•­**:
â€¢ 1ë‹¨ê³„: ì¶©ë¶„í•œ íœ´ì‹ê³¼ ìˆ˜ë¶„ ì„­ì·¨
â€¢ 2ë‹¨ê³„: ì¦ìƒ ëª¨ë‹ˆí„°ë§ (24-48ì‹œê°„)
â€¢ 3ë‹¨ê³„: ì§€ì†ì‹œ ì „ë¬¸ì˜ ìƒë‹´ í•„ìˆ˜

**âš ï¸ ì£¼ì˜ì‚¬í•­**: ê¸‰ì‘ìŠ¤ëŸ¬ìš´ ì•…í™”ì‹œ ì¦‰ì‹œ ì‘ê¸‰ì‹¤ ë°©ë¬¸

**ğŸ’¡ ì˜ˆë°© ê´€ë¦¬ë²•**:
âœ… ê·œì¹™ì ì¸ ìƒí™œíŒ¨í„´ ìœ ì§€
âœ… ì ì ˆí•œ ìš´ë™ê³¼ ì˜ì–‘ ê´€ë¦¬
âœ… ìŠ¤íŠ¸ë ˆìŠ¤ ê´€ë¦¬ ë° ì¶©ë¶„í•œ ìˆ˜ë©´

ë” êµ¬ì²´ì ì¸ ì¦ìƒì´ë‚˜ ìƒí™©ì„ ë§ì”€í•´ì£¼ì‹œë©´ ì •ë°€ ë¶„ì„í•´ë“œë¦¬ê² ìŠµë‹ˆë‹¤.`;
        }
        
        // ğŸ’¼ ë¹„ì¦ˆë‹ˆìŠ¤ ì‘ë‹µ
        function generateBusinessResponse(input) {
            return `ğŸ’¼ **ë¹„ì¦ˆë‹ˆìŠ¤ ì „ëµ ë¶„ì„**

**ğŸ¯ í˜„í™© ë¶„ì„**: "${input}"

**âš¡ í•µì‹¬ ì „ëµ**:
â€¢ **ìš°ì„ ìˆœìœ„ ë§¤íŠ¸ë¦­ìŠ¤**: ì¤‘ìš”ë„ Ã— ê¸´ê¸‰ë„ ë¶„ì„
â€¢ **ë¦¬ì†ŒìŠ¤ ìµœì í™”**: 20% í•µì‹¬ì—…ë¬´ì— 80% íˆ¬ì
â€¢ **ì„±ê³¼ ì§€í‘œ**: ëª…í™•í•œ KPI ì„¤ì • ë° ì¶”ì 

**ğŸš€ ì‹¤í–‰ ë°©ì•ˆ**:
1ï¸âƒ£ ë‹¨ê¸° ëª©í‘œ: ì¦‰ì‹œ ì‹¤í–‰ ê°€ëŠ¥í•œ ê°œì„ ì‚¬í•­
2ï¸âƒ£ ì¤‘ê¸° ì „ëµ: 3-6ê°œì›” ë¡œë“œë§µ ìˆ˜ë¦½
3ï¸âƒ£ ì¥ê¸° ë¹„ì „: 1ë…„ í›„ ëª©í‘œ ë‹¬ì„± ê³„íš

**ğŸ“Š ì„±ê³µ ì§€í‘œ**: ROI, ìƒì‚°ì„±, íŒ€ ë§Œì¡±ë„ ë“±ì„ í†µí•œ ì§€ì†ì  ëª¨ë‹ˆí„°ë§

êµ¬ì²´ì ì¸ ì—…ë¬´ ìƒí™©ì„ ê³µìœ í•´ì£¼ì‹œë©´ ë§ì¶¤í˜• ì†”ë£¨ì…˜ì„ ì œì‹œí•´ë“œë¦¬ê² ìŠµë‹ˆë‹¤.`;
        }
        
        // ğŸ”§ ê¸°ìˆ  ì‘ë‹µ
        function generateTechResponse(input) {
            return `ğŸ”§ **ê¸°ìˆ  ì†”ë£¨ì…˜ ë¶„ì„**

**ğŸ’» ê¸°ìˆ  ê²€í† **: "${input}"

**ğŸ› ï¸ ê¶Œì¥ ì†”ë£¨ì…˜**:
â€¢ **ì•„í‚¤í…ì²˜**: í™•ì¥ ê°€ëŠ¥í•œ ëª¨ë“ˆí˜• ì„¤ê³„
â€¢ **ê¸°ìˆ  ìŠ¤íƒ**: ìµœì‹  í”„ë ˆì„ì›Œí¬ ë° ë„êµ¬ í™œìš©
â€¢ **ì„±ëŠ¥ ìµœì í™”**: ìºì‹±, CDN, ë°ì´í„°ë² ì´ìŠ¤ íŠœë‹

**âš¡ ê°œë°œ í”„ë¡œì„¸ìŠ¤**:
1ï¸âƒ£ ìš”êµ¬ì‚¬í•­ ë¶„ì„ ë° ê¸°ìˆ  ê²€í† 
2ï¸âƒ£ í”„ë¡œí† íƒ€ì… ê°œë°œ ë° í…ŒìŠ¤íŠ¸
3ï¸âƒ£ ë°˜ë³µì  ê°œë°œ ë° ë°°í¬ (CI/CD)

**ğŸ” í’ˆì§ˆ ë³´ì¥**: ì½”ë“œ ë¦¬ë·°, ìë™í™” í…ŒìŠ¤íŠ¸, ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œ

í”„ë¡œì íŠ¸ì˜ êµ¬ì²´ì ì¸ ìš”êµ¬ì‚¬í•­ì„ ì•Œë ¤ì£¼ì‹œë©´ ìƒì„¸í•œ ê¸°ìˆ  ì„¤ê³„ì•ˆì„ ì œê³µí•´ë“œë¦¬ê² ìŠµë‹ˆë‹¤.`;
        }
        
        // ğŸ’­ ì‹¬ë¦¬ ì‘ë‹µ
        function generatePsychologyResponse(input) {
            return `ğŸ’­ **ì‹¬ë¦¬ ìƒë‹´ ë¶„ì„**

**ğŸ§  ê°ì • ìƒíƒœ**: "${input}"

**ğŸŒŸ ë§ˆìŒì±™ê¹€ ì ‘ê·¼ë²•**:
â€¢ **í˜„ì¬ ìˆœê°„ ì§‘ì¤‘**: 5-4-3-2-1 ê·¸ë¼ìš´ë”© ê¸°ë²•
â€¢ **ê°ì • ìˆ˜ìš©**: íŒë‹¨í•˜ì§€ ì•Šê³  ìˆëŠ” ê·¸ëŒ€ë¡œ ì¸ì •
â€¢ **í˜¸í¡ ì¡°ì ˆ**: 4-7-8 í˜¸í¡ë²•ìœ¼ë¡œ ë§ˆìŒ ì•ˆì •

**ğŸ’ª ëŒ€ì²˜ ì „ëµ**:
1ï¸âƒ£ ì¦‰ì‹œ ì•ˆì •í™”: ê¹Šì€ í˜¸í¡ ë° ê¸´ì¥ ì™„í™”
2ï¸âƒ£ ì¸ì§€ ì¬êµ¬ì„±: ë¶€ì •ì  ì‚¬ê³  íŒ¨í„´ ì „í™˜
3ï¸âƒ£ í–‰ë™ ê³„íš: êµ¬ì²´ì ì´ê³  ì‹¤í˜„ ê°€ëŠ¥í•œ ë‹¨ê³„

**ğŸ¤ ì§€ì§€ ì²´ê³„**: ê°€ì¡±, ì¹œêµ¬, ì „ë¬¸ê°€ì™€ì˜ ì†Œí†µ í™œì„±í™”

ì–´ë–¤ ê°ì •ì´ë‚˜ ìƒí™©ì¸ì§€ ë” ìì„¸íˆ ë§ì”€í•´ì£¼ì‹œë©´ ê°œì¸ë§ì¶¤ ì†”ë£¨ì…˜ì„ ì œê³µí•´ë“œë¦¬ê² ìŠµë‹ˆë‹¤.`;
        }
        
        // ğŸ¨ ì°½ì˜ì„± ì‘ë‹µ
        function generateCreativeResponse(input) {
            return `ğŸ¨ **ì°½ì˜ì  ì†”ë£¨ì…˜ ê°œë°œ**

**âœ¨ ì•„ì´ë””ì–´ íƒìƒ‰**: "${input}"

**ğŸŒŸ ì°½ì˜ì  ì‚¬ê³  ê¸°ë²•**:
â€¢ **ë¸Œë ˆì¸ìŠ¤í† ë°**: ììœ ë¡œìš´ ì•„ì´ë””ì–´ ë°œì‚°
â€¢ **SCAMPER**: ì²´ê³„ì  ì°½ì˜ í”„ë¡œì„¸ìŠ¤
â€¢ **ë§ˆì¸ë“œë§µ**: ì‹œê°ì  ì—°ìƒ í™•ì¥

**ğŸš€ í˜ì‹  í”„ë¡œì„¸ìŠ¤**:
1ï¸âƒ£ ë¬¸ì œ ì¬ì •ì˜: ë‹¤ë¥¸ ê´€ì ì—ì„œ ì ‘ê·¼
2ï¸âƒ£ ì•„ì´ë””ì–´ ìœµí•©: ì„œë¡œ ë‹¤ë¥¸ ê°œë… ê²°í•©
3ï¸âƒ£ í”„ë¡œí† íƒ€ì…: ë¹ ë¥¸ ì‹œí—˜ ë° ê°œì„ 

**ğŸ¯ ì‹¤í–‰ ì „ëµ**: ì‘ì€ ì‹¤í—˜ë¶€í„° ì‹œì‘í•˜ì—¬ ì ì§„ì  í™•ì¥

ì°½ì˜ì  í”„ë¡œì íŠ¸ë‚˜ ì•„ì´ë””ì–´ì— ëŒ€í•´ ë” êµ¬ì²´ì ìœ¼ë¡œ ë§ì”€í•´ì£¼ì‹œë©´ ë§ì¶¤í˜• ì°½ì‘ ì§€ì›ì„ í•´ë“œë¦¬ê² ìŠµë‹ˆë‹¤.`;
        }
        
        // ğŸ“Š ë°ì´í„° ì‘ë‹µ  
        function generateDataResponse(input) {
            return `ğŸ“Š **ë°ì´í„° ë¶„ì„ ì¸ì‚¬ì´íŠ¸**

**ğŸ” ë¶„ì„ ìš”ì²­**: "${input}"

**ğŸ“ˆ ë¶„ì„ í”„ë¡œì„¸ìŠ¤**:
â€¢ **ë°ì´í„° ìˆ˜ì§‘**: ê´€ë ¨ì„± ë†’ì€ ì •ë³´ í™•ë³´
â€¢ **ì „ì²˜ë¦¬**: ì •ì œ, ë³€í™˜, ê²°ì¸¡ì¹˜ ì²˜ë¦¬
â€¢ **ì‹œê°í™”**: íŒ¨í„´ ë° íŠ¸ë Œë“œ ë°œê²¬

**âš¡ ë¶„ì„ ë„êµ¬**:
1ï¸âƒ£ í†µê³„ ë¶„ì„: Python/R ê¸°ë°˜ ë¶„ì„
2ï¸âƒ£ ë¨¸ì‹ ëŸ¬ë‹: ì˜ˆì¸¡ ëª¨ë¸ êµ¬ì¶•
3ï¸âƒ£ ì‹œê°í™”: ëŒ€ì‹œë³´ë“œ ë° ë¦¬í¬íŠ¸

**ğŸ¯ ì‹¤í–‰ ê°€ëŠ¥í•œ ì¸ì‚¬ì´íŠ¸**: ë¹„ì¦ˆë‹ˆìŠ¤ ì˜ì‚¬ê²°ì • ì§€ì›

ë°ì´í„°ë‚˜ ë¶„ì„ ëª©í‘œë¥¼ êµ¬ì²´ì ìœ¼ë¡œ ì•Œë ¤ì£¼ì‹œë©´ ë§ì¶¤í˜• ë¶„ì„ ë°©ë²•ë¡ ì„ ì œì‹œí•´ë“œë¦¬ê² ìŠµë‹ˆë‹¤.`;
        }
        
        function generateFinanceResponse(input) {
            return `ğŸ’° **ê¸ˆìœµ íˆ¬ì ë¶„ì„**

**ğŸ’¹ íˆ¬ì ê²€í† **: "${input}"

**ğŸ“Š íˆ¬ì ì „ëµ**:
â€¢ **ë¦¬ìŠ¤í¬ ê´€ë¦¬**: ë¶„ì‚°íˆ¬ì ë° í¬íŠ¸í´ë¦¬ì˜¤ êµ¬ì„±
â€¢ **ìì‚° ë°°ë¶„**: ì—°ë ¹, ëª©í‘œì— ë”°ë¥¸ ìµœì í™”
â€¢ **ì‹œì¥ ë¶„ì„**: ê²½ì œ ì§€í‘œ ë° íŠ¸ë Œë“œ íŒŒì•…

**âš¡ ì‹¤í–‰ ë‹¨ê³„**:
1ï¸âƒ£ ì¬ì • í˜„í™© ë¶„ì„ ë° ëª©í‘œ ì„¤ì •
2ï¸âƒ£ íˆ¬ì ìƒí’ˆ ì„ ë³„ ë° ë¹„êµ
3ï¸âƒ£ ì •ê¸°ì  ëª¨ë‹ˆí„°ë§ ë° ë¦¬ë°¸ëŸ°ì‹±

**ğŸ¯ ì¥ê¸° ì „ëµ**: ë³µë¦¬ íš¨ê³¼ ê·¹ëŒ€í™” ë° ì¸í”Œë ˆì´ì…˜ ëŒ€ì‘

íˆ¬ì ëª©í‘œë‚˜ í˜„ì¬ ìƒí™©ì„ ë” ìì„¸íˆ ì•Œë ¤ì£¼ì‹œë©´ ë§ì¶¤í˜• í¬íŠ¸í´ë¦¬ì˜¤ë¥¼ ì œì•ˆí•´ë“œë¦¬ê² ìŠµë‹ˆë‹¤.`;
        }
        
        // ğŸ“ˆ ë§ˆì¼€íŒ… ì‘ë‹µ
        function generateMarketingResponse(input) {
            return `ğŸ“ˆ **ë§ˆì¼€íŒ… ì „ëµ ë° ë¸Œëœë”©**

**ğŸ¯ ë§ˆì¼€íŒ… ë¶„ì„**: "${input}"

**ğŸš€ í•µì‹¬ ë§ˆì¼€íŒ… ì „ëµ**:
â€¢ **íƒ€ê²Ÿ ë¶„ì„**: ê³ ê° í˜ë¥´ì†Œë‚˜ ë° ì‹œì¥ ì„¸ë¶„í™”
â€¢ **ì±„ë„ ìµœì í™”**: SNS, ì½˜í…ì¸ , í¼í¬ë¨¼ìŠ¤ ë§ˆì¼€íŒ…
â€¢ **ë¸Œëœë“œ í¬ì§€ì…”ë‹**: ì°¨ë³„í™”ëœ ë¸Œëœë“œ ê°€ì¹˜ ì „ë‹¬

**âš¡ ì‹¤í–‰ ê³„íš**:
1ï¸âƒ£ ì‹œì¥ ì¡°ì‚¬ ë° ê²½ìŸì‚¬ ë¶„ì„
2ï¸âƒ£ í†µí•© ë§ˆì¼€íŒ… ì „ëµ ìˆ˜ë¦½
3ï¸âƒ£ ìº í˜ì¸ ì‹¤í–‰ ë° ì„±ê³¼ ì¸¡ì •

**ğŸ“Š ì„±ê³¼ ì§€í‘œ**: ë¸Œëœë“œ ì¸ì§€ë„, ë¦¬ë“œ ìƒì„±, ì „í™˜ìœ¨ í–¥ìƒ

ì–´ë–¤ ì œí’ˆì´ë‚˜ ì„œë¹„ìŠ¤ì¸ì§€ ì•Œë ¤ì£¼ì‹œë©´ ë§ì¶¤í˜• ë§ˆì¼€íŒ… ì†”ë£¨ì…˜ì„ ì œê³µí•´ë“œë¦¬ê² ìŠµë‹ˆë‹¤.`;
        }
        
        // ê¸°íƒ€ ì‘ë‹µ í•¨ìˆ˜ë“¤ë„ ë¹„ìŠ·í•˜ê²Œ êµ¬í˜„...
        function generateSEOResponse(input) {
            return `ğŸ” **SEO ìµœì í™” ì „ëµ**

**ğŸ“Š í˜„ì¬ ìƒí™© ë¶„ì„**: "${input}"

**ğŸ¯ í•µì‹¬ SEO ì „ëµ**:
â€¢ **í‚¤ì›Œë“œ ì—°êµ¬**: ê²€ìƒ‰ëŸ‰ ë†’ì€ íƒ€ê²Ÿ í‚¤ì›Œë“œ ë°œêµ´
â€¢ **ì½˜í…ì¸  ìµœì í™”**: ì‚¬ìš©ì ì˜ë„ì— ë§ëŠ” ê³ í’ˆì§ˆ ì½˜í…ì¸ 
â€¢ **ê¸°ìˆ ì  SEO**: í˜ì´ì§€ ì†ë„, ëª¨ë°”ì¼ ìµœì í™”, êµ¬ì¡°í™”ëœ ë°ì´í„°

**âš¡ ì‹¤í–‰ ë‹¨ê³„**:
1ï¸âƒ£ í‚¤ì›Œë“œ ë¶„ì„ ë° ê²½ìŸì‚¬ ì¡°ì‚¬
2ï¸âƒ£ ì˜¨í˜ì´ì§€ ìµœì í™” ë° ì½˜í…ì¸  ê°œì„ 
3ï¸âƒ£ ë°±ë§í¬ êµ¬ì¶• ë° ê¸°ìˆ ì  ê°œì„ 

**ğŸ“ˆ ì„±ê³¼ ì¸¡ì •**: ê²€ìƒ‰ ìˆœìœ„, íŠ¸ë˜í”½, ì „í™˜ìœ¨ ëª¨ë‹ˆí„°ë§

êµ¬ì²´ì ì¸ ì›¹ì‚¬ì´íŠ¸ë‚˜ ëª©í‘œë¥¼ ì•Œë ¤ì£¼ì‹œë©´ ë§ì¶¤í˜• SEO ì „ëµì„ ì œì‹œí•´ë“œë¦¬ê² ìŠµë‹ˆë‹¤.`;
        }
        
        function generateWritingResponse(input) {
            return `âœï¸ **ê¸€ì“°ê¸° ë§ˆìŠ¤í„° ê°€ì´ë“œ**

**ï¿½ ê¸€ì“°ê¸° ìš”ì²­**: "${input}"

**ğŸ¯ íš¨ê³¼ì ì¸ ê¸€ì“°ê¸° ì „ëµ**:
â€¢ **êµ¬ì¡°í™”**: ì„œë¡ -ë³¸ë¡ -ê²°ë¡ ì˜ ëª…í™•í•œ êµ¬ì„±
â€¢ **ë…ì ì¤‘ì‹¬**: íƒ€ê²Ÿ ë…ìì˜ ê´€ì‹¬ì‚¬ì™€ ìˆ˜ì¤€ ê³ ë ¤
â€¢ **ìŠ¤í† ë¦¬í…”ë§**: ê°ì •ì  ì—°ê²°ì„ ë§Œë“œëŠ” ì´ì•¼ê¸° êµ¬ì¡°

**âš¡ ê¸€ì“°ê¸° í”„ë¡œì„¸ìŠ¤**:
1ï¸âƒ£ ëª©ì ê³¼ ë…ì ì •ì˜ ë° ì•„ì›ƒë¼ì¸ ì‘ì„±
2ï¸âƒ£ í•µì‹¬ ë©”ì‹œì§€ ì¤‘ì‹¬ì˜ ì´ˆì•ˆ ì‘ì„±
3ï¸âƒ£ í‡´ê³  ë° ìµœì¢… í¸ì§‘

**ğŸ’¡ ì‹¤ìš© íŒ**: ê°„ê²°í•¨, êµ¬ì²´ì„±, ë…ì°½ì„±ì„ í†µí•œ ê¸€ì˜ ì™„ì„±ë„ í–¥ìƒ

ì–´ë–¤ ì¢…ë¥˜ì˜ ê¸€ì„ ì“°ì‹œëŠ”ì§€ ì•Œë ¤ì£¼ì‹œë©´ ë” êµ¬ì²´ì ì¸ ê°€ì´ë“œë¥¼ ì œê³µí•´ë“œë¦¬ê² ìŠµë‹ˆë‹¤.`;
        }
        
        function generateHRResponse(input) {
            return `ğŸ‘¥ **ì¸ì‚¬ ê´€ë¦¬ ì†”ë£¨ì…˜**

**ğŸ” ì¸ì‚¬ ì´ìŠˆ**: "${input}"

**ğŸ’¼ íš¨ê³¼ì ì¸ ì¸ì‚¬ ì „ëµ**:
â€¢ **ì±„ìš©**: ì í•©í•œ ì¸ì¬ ë°œêµ´ ë° ì„ ë°œ ì‹œìŠ¤í…œ
â€¢ **ê°œë°œ**: ì§ì› ì„±ì¥ì„ ìœ„í•œ êµìœ¡ ë° ë©˜í† ë§
â€¢ **í‰ê°€**: ê³µì •í•˜ê³  íˆ¬ëª…í•œ ì„±ê³¼ ê´€ë¦¬ ì²´ê³„

**âš¡ ì‹¤í–‰ ë°©ì•ˆ**:
1ï¸âƒ£ ì¡°ì§ ë¶„ì„ ë° ì¸ë ¥ ê³„íš ìˆ˜ë¦½
2ï¸âƒ£ ì±„ìš© í”„ë¡œì„¸ìŠ¤ ìµœì í™” ë° ì˜¨ë³´ë”©
3ï¸âƒ£ ì„±ê³¼ ê´€ë¦¬ ë° ê²½ë ¥ ê°œë°œ ì§€ì›

**ğŸ¯ ì„±ê³µ ì§€í‘œ**: ì§ì› ë§Œì¡±ë„, ìœ ì§€ìœ¨, ìƒì‚°ì„± í–¥ìƒ

êµ¬ì²´ì ì¸ ì¡°ì§ ìƒí™©ì„ ê³µìœ í•´ì£¼ì‹œë©´ ë§ì¶¤í˜• ì¸ì‚¬ ì†”ë£¨ì…˜ì„ ì œì•ˆí•´ë“œë¦¬ê² ìŠµë‹ˆë‹¤.`;
        }
        
        function generateAssistantResponse(input) {
            return `ğŸ¤– **ì—…ë¬´ íš¨ìœ¨í™” ì†”ë£¨ì…˜**

**âš¡ ì—…ë¬´ ìš”ì²­**: "${input}"

**ğŸ¯ íš¨ìœ¨ì„± í–¥ìƒ ì „ëµ**:
â€¢ **ìë™í™”**: ë°˜ë³µ ì—…ë¬´ì˜ ì‹œìŠ¤í…œí™” ë° ë„êµ¬ í™œìš©
â€¢ **ìš°ì„ ìˆœìœ„**: ì¤‘ìš”ë„ì™€ ê¸´ê¸‰ë„ì— ë”°ë¥¸ ì—…ë¬´ ë¶„ë¥˜
â€¢ **ì‹œê°„ ê´€ë¦¬**: ì§‘ì¤‘ ì‹œê°„ í™•ë³´ ë° ì¼ì • ìµœì í™”

**âš¡ ì‹¤í–‰ ë„êµ¬**:
1ï¸âƒ£ í”„ë¡œì íŠ¸ ê´€ë¦¬: Notion, Trello, Asana í™œìš©
2ï¸âƒ£ ì˜ì‚¬ì†Œí†µ: Slack, Teamsë¥¼ í†µí•œ íš¨ìœ¨ì  í˜‘ì—…
3ï¸âƒ£ ìë™í™”: Zapier, Power Automateë¡œ ë°˜ë³µ ì‘ì—… í•´ê²°

**ğŸ“Š ì„±ê³¼ ì¸¡ì •**: ì—…ë¬´ ì²˜ë¦¬ ì‹œê°„ ë‹¨ì¶• ë° í’ˆì§ˆ í–¥ìƒ

ì–´ë–¤ ì—…ë¬´ë¥¼ ê°œì„ í•˜ê³  ì‹¶ìœ¼ì‹ ì§€ ì•Œë ¤ì£¼ì‹œë©´ êµ¬ì²´ì ì¸ íš¨ìœ¨í™” ë°©ì•ˆì„ ì œì‹œí•´ë“œë¦¬ê² ìŠµë‹ˆë‹¤.`;
        }
        
        function generateStartupResponse(input) {
            return `ğŸš€ **ì°½ì—… ì„±ê³µ ë¡œë“œë§µ**

**ğŸ’¡ ì°½ì—… ì•„ì´ë””ì–´**: "${input}"

**ğŸ¯ ì„±ê³µì ì¸ ì°½ì—… ì „ëµ**:
â€¢ **ì‹œì¥ ê²€ì¦**: ê³ ê° ë‹ˆì¦ˆ íŒŒì•… ë° MVP í…ŒìŠ¤íŠ¸
â€¢ **ë¹„ì¦ˆë‹ˆìŠ¤ ëª¨ë¸**: ìˆ˜ìµ êµ¬ì¡° ì„¤ê³„ ë° ê²½ìŸë ¥ í™•ë³´
â€¢ **ìê¸ˆ ì¡°ë‹¬**: íˆ¬ì ìœ ì¹˜ ë° ì¬ì • ê´€ë¦¬ ê³„íš

**âš¡ ë‹¨ê³„ë³„ ì‹¤í–‰**:
1ï¸âƒ£ ì•„ì´ë””ì–´ ê²€ì¦ ë° ì‹œì¥ ì¡°ì‚¬
2ï¸âƒ£ ì‚¬ì—… ê³„íšì„œ ì‘ì„± ë° íŒ€ êµ¬ì„±
3ï¸âƒ£ í”„ë¡œí† íƒ€ì… ê°œë°œ ë° ì´ˆê¸° ê³ ê° í™•ë³´

**ğŸ’° ì„±ì¥ ì „ëµ**: ìŠ¤ì¼€ì¼ì—…ì„ ìœ„í•œ ë§ˆì¼€íŒ… ë° ìš´ì˜ ì²´ê³„ êµ¬ì¶•

ì°½ì—… ë¶„ì•¼ë‚˜ í˜„ì¬ ë‹¨ê³„ë¥¼ ì•Œë ¤ì£¼ì‹œë©´ ë§ì¶¤í˜• ì°½ì—… ì „ëµì„ ì œê³µí•´ë“œë¦¬ê² ìŠµë‹ˆë‹¤.`;
        }
        
        function generateShoppingResponse(input) {
            return `ğŸ›ï¸ **ìŠ¤ë§ˆíŠ¸ ì‡¼í•‘ ê°€ì´ë“œ**

**ğŸ” ì‡¼í•‘ ìš”ì²­**: "${input}"

**ğŸ’° í˜„ëª…í•œ êµ¬ë§¤ ì „ëµ**:
â€¢ **ë¹„êµ ë¶„ì„**: ê°€ê²©, í’ˆì§ˆ, ë¦¬ë·°ë¥¼ ì¢…í•©í•œ ì œí’ˆ ë¹„êµ
â€¢ **íƒ€ì´ë°**: í• ì¸ ì‹œê¸° ë° ì‹œì¦Œë³„ ìµœì  êµ¬ë§¤ ì‹œì 
â€¢ **ë¸Œëœë“œ ì‹ ë¢°ë„**: AS, ë³´ì¦, ì‚¬ìš©ì í›„ê¸° ê²€í† 

**âš¡ êµ¬ë§¤ í”„ë¡œì„¸ìŠ¤**:
1ï¸âƒ£ ë‹ˆì¦ˆ ë¶„ì„ ë° ì˜ˆì‚° ì„¤ì •
2ï¸âƒ£ ì œí’ˆ ë¹„êµ ë° ë¦¬ë·° ë¶„ì„
3ï¸âƒ£ ìµœì  íƒ€ì´ë° êµ¬ë§¤ ë° ì‚¬í›„ ê´€ë¦¬

**ğŸ ì¶”ê°€ í˜œíƒ**: ì¿ í°, ì ë¦½ê¸ˆ, ë©¤ë²„ì‹­ í˜œíƒ í™œìš©ë²•

êµ¬ì²´ì ì¸ ì œí’ˆì´ë‚˜ ì‡¼í•‘ ëª©ì ì„ ì•Œë ¤ì£¼ì‹œë©´ ë§ì¶¤í˜• êµ¬ë§¤ ê°€ì´ë“œë¥¼ ì œê³µí•´ë“œë¦¬ê² ìŠµë‹ˆë‹¤.`;
        }
        
        function generateGrowthResponse(input) {
            return `ğŸŒ± **ê°œì¸ ì„±ì¥ ë¡œë“œë§µ**

**ğŸ¯ ì„±ì¥ ëª©í‘œ**: "${input}"

**ğŸš€ ì²´ê³„ì ì¸ ì„±ì¥ ì „ëµ**:
â€¢ **ëª©í‘œ ì„¤ì •**: SMART ì›ì¹™ì— ë”°ë¥¸ êµ¬ì²´ì  ëª©í‘œ ìˆ˜ë¦½
â€¢ **ìŠµê´€ í˜•ì„±**: ì‘ì€ ë³€í™”ë¥¼ í†µí•œ ì§€ì† ê°€ëŠ¥í•œ ì„±ì¥
â€¢ **í”¼ë“œë°±**: ì •ê¸°ì  ì ê²€ ë° ë°©í–¥ ì¡°ì •

**âš¡ ì„±ì¥ í”„ë¡œì„¸ìŠ¤**:
1ï¸âƒ£ í˜„ì¬ ìƒíƒœ ë¶„ì„ ë° ëª©í‘œ ëª…í™•í™”
2ï¸âƒ£ ì‹¤í–‰ ê³„íš ìˆ˜ë¦½ ë° ì¼ì¼ ë£¨í‹´ êµ¬ì¶•
3ï¸âƒ£ ì§€ì†ì  ëª¨ë‹ˆí„°ë§ ë° ê°œì„ 

**ğŸ’ª ë™ê¸° ìœ ì§€**: ì„±ì·¨ ê¸°ë¡, ë³´ìƒ ì‹œìŠ¤í…œ, ì„±ì¥ ì»¤ë®¤ë‹ˆí‹° ì°¸ì—¬

ì–´ë–¤ ë¶„ì•¼ì—ì„œ ì„±ì¥í•˜ê³  ì‹¶ìœ¼ì‹ ì§€ ì•Œë ¤ì£¼ì‹œë©´ ê°œì¸ë§ì¶¤ ì„±ì¥ ê³„íšì„ ì„¸ì›Œë“œë¦¬ê² ìŠµë‹ˆë‹¤.`;
        }
        
        function generateFortuneResponse(input) {
            return `ğŸ”® **ìš´ì„¸ ë° ë¯¸ë˜ ì¸ì‚¬ì´íŠ¸**

**âœ¨ ìš´ì„¸ ìš”ì²­**: "${input}"

**ğŸŒŸ ì˜¤ëŠ˜ì˜ ìš´ì„¸ í•´ì„**:
â€¢ **ì¢…í•© ìš´**: ì „ë°˜ì ì¸ ì—ë„ˆì§€ì™€ íë¦„ ë¶„ì„
â€¢ **ì¸ê°„ê´€ê³„**: ëŒ€ì¸ê´€ê³„ì—ì„œì˜ ì£¼ì˜ì ê³¼ ê¸°íšŒ
â€¢ **ì¼ê³¼ ì„±ê³µ**: ì—…ë¬´ì™€ ëª©í‘œ ë‹¬ì„±ì„ ìœ„í•œ ì¡°ì–¸

**âš¡ ê¸ì •ì  ë³€í™” ê°€ì´ë“œ**:
1ï¸âƒ£ í˜„ì¬ ìƒí™©ì— ëŒ€í•œ í†µì°°ê³¼ í•´ì„
2ï¸âƒ£ ì•ìœ¼ë¡œì˜ ê¸°íšŒì™€ ì£¼ì˜ì‚¬í•­
3ï¸âƒ£ ìš´ì„ ë” ì¢‹ê²Œ ë§Œë“œëŠ” ì‹¤ì²œ ë°©ë²•

**ğŸ€ í–‰ìš´ íŒ**: ê¸ì •ì  ë§ˆì¸ë“œ, ê°ì‚¬í•œ ë§ˆìŒ, ì ê·¹ì  í–‰ë™ìœ¼ë¡œ ìš´ëª… ê°œì„ 

êµ¬ì²´ì ì¸ ê³ ë¯¼ì´ë‚˜ ê¶ê¸ˆí•œ ë¶„ì•¼ë¥¼ ë§ì”€í•´ì£¼ì‹œë©´ ë” ìì„¸í•œ ìš´ì„¸ë¥¼ ë´ë“œë¦¬ê² ìŠµë‹ˆë‹¤.`;
        }
        
        function generateEducationResponse(input) {
            return `ï¿½ **í•™ìŠµ ì„¤ê³„ ë° ë©˜í† ë§**

íš¨ê³¼ì ì¸ í•™ìŠµ ë°©ë²•ê³¼ ê°œì¸ë§ì¶¤ êµìœ¡ ê³„íšì„ ì œê³µí•´ë“œë¦¬ê² ìŠµë‹ˆë‹¤.

"${input}"ì— ëŒ€í•œ ì²´ê³„ì ì¸ í•™ìŠµ ë¡œë“œë§µì„ í•¨ê»˜ ë§Œë“¤ì–´ë³´ì„¸ìš”!`;
        }
        
        function generateLegalResponse(input) {
            return `âš–ï¸ **ë²•ë¥  ìë¬¸ ë° í•´ì„**

ë²•ì  ì´ìŠˆì— ëŒ€í•œ ì „ë¬¸ì ì¸ ë¶„ì„ê³¼ ëŒ€ì‘ ë°©ì•ˆì„ ì œì‹œí•´ë“œë¦¬ê² ìŠµë‹ˆë‹¤.

"${input}" ê´€ë ¨í•˜ì—¬ ë²•ì  ê²€í†  ë° ì¡°ì¹˜ì‚¬í•­ì„ ì•ˆë‚´í•´ë“œë¦¬ê² ìŠµë‹ˆë‹¤.`;
        }
        
        function generateWellnessResponse(input) {
            return `ğŸ§˜ **ì›°ë‹ˆìŠ¤ ë° ë¼ì´í”„ìŠ¤íƒ€ì¼**

ê±´ê°•í•œ ì‚¶ì„ ìœ„í•œ ì¢…í•©ì ì¸ ì›°ë‹ˆìŠ¤ ì†”ë£¨ì…˜ì„ ì œê³µí•´ë“œë¦¬ê² ìŠµë‹ˆë‹¤.

"${input}"ë¥¼ í†µí•´ ë” ë‚˜ì€ ë¼ì´í”„ìŠ¤íƒ€ì¼ì„ ë§Œë“¤ì–´ê°€ì„¸ìš”!`;
        }
        
        function generateTravelResponse(input) {
            return `ğŸ—ºï¸ **ì—¬í–‰ ê³„íš ë° ë¬¸í™” íƒë°©**

ì™„ë²½í•œ ì—¬í–‰ ê³„íšê³¼ í˜„ì§€ ë¬¸í™” ì²´í—˜ ê°€ì´ë“œë¥¼ ì œê³µí•´ë“œë¦¬ê² ìŠµë‹ˆë‹¤.

"${input}" ê´€ë ¨í•˜ì—¬ íŠ¹ë³„í•œ ì—¬í–‰ ê²½í—˜ì„ ì„¤ê³„í•´ë³´ì„¸ìš”!`;
        }
        
        function generateLanguageResponse(input) {
            return `ğŸŒ **ì–¸ì–´ í•™ìŠµ ë° ë‹¤ë¬¸í™” ì†Œí†µ**

íš¨ê³¼ì ì¸ ì–¸ì–´ í•™ìŠµë²•ê³¼ ë¬¸í™”ê°„ ì†Œí†µ ì „ëµì„ ì œê³µí•´ë“œë¦¬ê² ìŠµë‹ˆë‹¤.

"${input}"ë¥¼ í†µí•´ ê¸€ë¡œë²Œ ì†Œí†µ ëŠ¥ë ¥ì„ í–¥ìƒì‹œì¼œë³´ì„¸ìš”!`;
        }
        
        function generateCareerResponse(input) {
            return `ğŸ¯ **ì»¤ë¦¬ì–´ ê°œë°œ ë° ì§„ë¡œ ì„¤ê³„**

ì„±ê³µì ì¸ ì»¤ë¦¬ì–´ ë°œì „ì„ ìœ„í•œ ë§ì¶¤í˜• ì „ëµì„ ì œê³µí•´ë“œë¦¬ê² ìŠµë‹ˆë‹¤.

"${input}" ê´€ë ¨í•˜ì—¬ ì»¤ë¦¬ì–´ ë¡œë“œë§µì„ í•¨ê»˜ ì„¤ê³„í•´ë³´ì„¸ìš”!`;
        }
        
        function generateRelationshipResponse(input) {
            return `ğŸ’ **ì¸ê°„ê´€ê³„ ë° ì†Œí†µ ê°œì„ **

ê±´ê°•í•œ ê´€ê³„ êµ¬ì¶•ê³¼ íš¨ê³¼ì ì¸ ì†Œí†µ ì „ëµì„ ì œê³µí•´ë“œë¦¬ê² ìŠµë‹ˆë‹¤.

"${input}"ë¥¼ í†µí•´ ë” ë‚˜ì€ ì¸ê°„ê´€ê³„ë¥¼ ë§Œë“¤ì–´ê°€ì„¸ìš”!`;
        }
        
        function generateWiseResponse(input) {
            return `ğŸ‘´ **ë§ˆì„ ì´Œì¥ì˜ ì§€í˜œ**

ì˜¤ëœ ê²½í—˜ê³¼ ì§€í˜œë¡œ ëª¨ë“  ë¬¸ì œì— ëŒ€í•œ í†µì°°ì„ ì œê³µí•´ë“œë¦¬ê² ìŠµë‹ˆë‹¤.

"${input}"ì— ëŒ€í•´ í•¨ê»˜ ê¹Šì´ ìƒê°í•´ë³´ê³  ì§€í˜œë¡œìš´ í•´ë‹µì„ ì°¾ì•„ë³´ì„¸ìš”.

**ğŸŒŸ ì‚¶ì˜ ì§€í˜œ**:
â€¢ ëª¨ë“  ë¬¸ì œì—ëŠ” ë°˜ë“œì‹œ í•´ê²°ì±…ì´ ìˆìŠµë‹ˆë‹¤
â€¢ ë•Œë¡œëŠ” ë‹¤ë¥¸ ê´€ì ì—ì„œ ë³´ëŠ” ê²ƒì´ í•„ìš”í•©ë‹ˆë‹¤
â€¢ ì‘ì€ ë³€í™”ê°€ í° ê²°ê³¼ë¥¼ ë§Œë“¤ì–´ëƒ…ë‹ˆë‹¤`;
        }
        
        // ğŸ¤– ë„ê¹¨ë¹„ AI ì‹œìŠ¤í…œ ì‹œì‘
        function startGoblinAI(goblin3D, goblinData) {
            if (!goblin3D || !goblinData) return;
            
            // ë„ê¹¨ë¹„ AI í–‰ë™ ë°ì´í„° ì´ˆê¸°í™”
            goblin3D.userData.aiState = {
                isActive: true,
                lastAction: Date.now(),
                currentMood: 'happy',
                interactionCount: 0,
                specialties: goblinData.specialties || []
            };
            
            // ëœë¤ AI í–‰ë™ ì‹œì‘
            const behaviorInterval = setInterval(() => {
                if (!goblin3D.userData.aiState.isActive) {
                    clearInterval(behaviorInterval);
                    return;
                }
                
                // ëœë¤ í–‰ë™ ì„ íƒ
                const actions = ['wave', 'bounce', 'rotate', 'glow'];
                const randomAction = actions[Math.floor(Math.random() * actions.length)];
                
                performGoblinAction(goblin3D, randomAction);
                
            }, 5000 + Math.random() * 10000); // 5-15ì´ˆë§ˆë‹¤ í–‰ë™
            
            console.log(`ğŸ¤– ${goblinData.name} ë„ê¹¨ë¹„ AI í™œì„±í™”`);
        }
        
        // ğŸ­ ë„ê¹¨ë¹„ í–‰ë™ ì‹¤í–‰
        function performGoblinAction(goblin3D, action) {
            if (!goblin3D || !gsap) return;
            
            switch(action) {
                case 'wave':
                    // ì† í”ë“¤ê¸° (íšŒì „ ì• ë‹ˆë©”ì´ì…˜)
                    gsap.to(goblin3D.rotation, {
                        z: goblin3D.rotation.z + 0.3,
                        duration: 0.5,
                        yoyo: true,
                        repeat: 3
                    });
                    break;
                    
                case 'bounce':
                    // í†µí†µ íŠ€ê¸°
                    gsap.to(goblin3D.position, {
                        y: goblin3D.position.y + 1,
                        duration: 0.5,
                        yoyo: true,
                        repeat: 1,
                        ease: "bounce.out"
                    });
                    break;
                    
                case 'rotate':
                    // í•œ ë°”í€´ ëŒê¸°
                    gsap.to(goblin3D.rotation, {
                        y: goblin3D.rotation.y + Math.PI * 2,
                        duration: 2,
                        ease: "power2.inOut"
                    });
                    break;
                    
                case 'glow':
                    // ë°˜ì§ì´ê¸° (ìƒ‰ìƒ ë³€í™”)
                    if (goblin3D.children[0] && goblin3D.children[0].material) {
                        const originalColor = goblin3D.children[0].material.color.getHex();
                        goblin3D.children[0].material.color.setHex(0xffffff);
                        setTimeout(() => {
                            goblin3D.children[0].material.color.setHex(originalColor);
                        }, 500);
                    }
                    break;
            }
        }
        
        
        // ğŸ® ì• ë‹ˆë©”ì´ì…˜ ë° ìƒí˜¸ì‘ìš© ì‹œìŠ¤í…œ
        function startAnimationSystem() {
            // ë„ê¹¨ë¹„ë“¤ì˜ ìë™ ì• ë‹ˆë©”ì´ì…˜
            goblins3D.forEach((goblin, index) => {
                const goblinData = goblinDatabase[index];
                
                // ë– ë‹¤ë‹ˆëŠ” ì• ë‹ˆë©”ì´ì…˜
                gsap.to(goblin.position, {
                    y: goblin.position.y + 0.3,
                    duration: 2 + Math.random() * 2,
                    yoyo: true,
                    repeat: -1,
                    ease: "sine.inOut",
                    delay: Math.random() * 2
                });
                
                // íšŒì „ ì• ë‹ˆë©”ì´ì…˜
                gsap.to(goblin.rotation, {
                    y: goblin.rotation.y + Math.PI * 2,
                    duration: 10 + Math.random() * 10,
                    repeat: -1,
                    ease: "none"
                });
                
                // ë„ê¹¨ë¹„ë³„ íŠ¹ë³„ íš¨ê³¼
                setTimeout(() => {
                    addGoblinSpecialEffects(goblin, goblinData);
                }, index * 500);
            });
        }
        
        // âœ¨ ë„ê¹¨ë¹„ë³„ íŠ¹ë³„ íš¨ê³¼
        function addGoblinSpecialEffects(goblin, goblinData) {
            const specialties = goblinData.specialties;
            
            // ì˜ë£Œ ë„ê¹¨ë¹„ - íë§ ì˜¤ë¼
            if (specialties.includes('ê±´ê°•') || specialties.includes('ì˜í•™')) {
                addHealingAura(goblin);
            }
            // ê¸°ìˆ  ë„ê¹¨ë¹„ - ë””ì§€í„¸ íŒŒí‹°í´
            else if (specialties.includes('ê°œë°œ') || specialties.includes('ê¸°ìˆ ')) {
                addTechParticles(goblin);
            }
            // ì°½ì˜ ë„ê¹¨ë¹„ - ë¬´ì§€ê°œ íš¨ê³¼
            else if (specialties.includes('ì°½ì˜ì„±') || specialties.includes('ë””ìì¸')) {
                addRainbowEffect(goblin);
            }
            // ê¸ˆìœµ ë„ê¹¨ë¹„ - ê³¨ë“œ ì´í™íŠ¸
            else if (specialties.includes('íˆ¬ì') || specialties.includes('ê¸ˆìœµ')) {
                addGoldEffect(goblin);
            }
            // ê¸°ë³¸ ë§ˆë²• ì˜¤ë¼
            else {
                addMagicalAura(goblin);
            }
        }
        
        // ï¿½ íë§ ì˜¤ë¼ íš¨ê³¼
        function addHealingAura(goblin) {
            const geometry = new THREE.RingGeometry(0.5, 1, 16);
            const material = new THREE.MeshBasicMaterial({
                color: 0x00ff88,
                transparent: true,
                opacity: 0.3,
                side: THREE.DoubleSide
            });
            
            const aura = new THREE.Mesh(geometry, material);
            aura.rotation.x = Math.PI / 2;
            aura.position.y = -0.5;
            goblin.add(aura);
            
            gsap.to(aura.rotation, {
                z: Math.PI * 2,
                duration: 4,
                repeat: -1,
                ease: "none"
            });
        }
        
        // âš¡ ë””ì§€í„¸ íŒŒí‹°í´ íš¨ê³¼
        function addTechParticles(goblin) {
            const particleCount = 20;
            const geometry = new THREE.BufferGeometry();
            const positions = new Float32Array(particleCount * 3);
            
            for (let i = 0; i < particleCount; i++) {
                positions[i * 3] = (Math.random() - 0.5) * 2;
                positions[i * 3 + 1] = Math.random() * 2;
                positions[i * 3 + 2] = (Math.random() - 0.5) * 2;
            }
            
            geometry.setAttribute('position', new THREE.BufferAttribute(positions, 3));
            
            const material = new THREE.PointsMaterial({
                color: 0x00aaff,
                size: 0.05,
                transparent: true,
                opacity: 0.8
            });
            
            const particles = new THREE.Points(geometry, material);
            goblin.add(particles);
            
            gsap.to(particles.rotation, {
                y: Math.PI * 2,
                duration: 3,
                repeat: -1,
                ease: "none"
            });
        }
        
        // ğŸŒˆ ë¬´ì§€ê°œ íš¨ê³¼
        function addRainbowEffect(goblin) {
            const geometry = new THREE.SphereGeometry(1.2, 16, 8);
            const material = new THREE.MeshBasicMaterial({
                color: 0xff6b6b,
                transparent: true,
                opacity: 0.1,
                wireframe: true
            });
            
            const rainbow = new THREE.Mesh(geometry, material);
            goblin.add(rainbow);
            
            gsap.to(rainbow.material, {
                opacity: 0.3,
                duration: 2,
                yoyo: true,
                repeat: -1,
                ease: "sine.inOut"
            });
            
            // ìƒ‰ìƒ ë³€í™”
            let hue = 0;
            const updateColor = () => {
                hue += 0.01;
                rainbow.material.color.setHSL(hue % 1, 1, 0.5);
                requestAnimationFrame(updateColor);
            };
            updateColor();
        }
        
        // ğŸ’° ê³¨ë“œ ì´í™íŠ¸
        function addGoldEffect(goblin) {
            const coins = [];
            for (let i = 0; i < 5; i++) {
                const geometry = new THREE.CylinderGeometry(0.1, 0.1, 0.02, 8);
                const material = new THREE.MeshBasicMaterial({ color: 0xffd700 });
                const coin = new THREE.Mesh(geometry, material);
                
                coin.position.set(
                    (Math.random() - 0.5) * 2,
                    Math.random() * 2 + 1,
                    (Math.random() - 0.5) * 2
                );
                
                goblin.add(coin);
                coins.push(coin);
                
                gsap.to(coin.rotation, {
                    y: Math.PI * 2,
                    duration: 1 + Math.random(),
                    repeat: -1,
                    ease: "none"
                });
                
                gsap.to(coin.position, {
                    y: coin.position.y + 0.5,
                    duration: 2,
                    yoyo: true,
                    repeat: -1,
                    ease: "sine.inOut",
                    delay: i * 0.2
                });
            }
        }
        
        // âœ¨ ê¸°ë³¸ ë§ˆë²• ì˜¤ë¼
        function addMagicalAura(goblin) {
            const geometry = new THREE.SphereGeometry(0.8, 8, 6);
            const material = new THREE.MeshBasicMaterial({
                color: 0x9b59b6,
                transparent: true,
                opacity: 0.15,
                wireframe: true
            });
            
            const aura = new THREE.Mesh(geometry, material);
            goblin.add(aura);
            
            gsap.to(aura.scale, {
                x: 1.2, y: 1.2, z: 1.2,
                duration: 3,
                yoyo: true,
                repeat: -1,
                ease: "sine.inOut"
            });
        }
        
        // ğŸ® ì»¨íŠ¸ë¡¤ ê¸°ëŠ¥ë“¤
        function toggleAutoRotate() {
            if (!controls) return; // ì•ˆì „ì¥ì¹˜
            controls.autoRotate = !controls.autoRotate;
            updateStatus(`ìë™ íšŒì „: ${controls.autoRotate ? 'ON' : 'OFF'}`);
        }
        
        function toggleDay() {
            isDay = !isDay;
            updateSceneBackground();
            updateStatus(`ì‹œê°„: ${isDay ? 'ë‚®' : 'ë°¤'}`);
        }
        
        function toggleWeather() {
            hasWeather = !hasWeather;
            if (hasWeather) {
                addWeatherEffect();
            } else {
                removeWeatherEffect();
            }
            updateStatus(`ë‚ ì”¨ íš¨ê³¼: ${hasWeather ? 'ON' : 'OFF'}`);
        }
        
        function resetCamera() {
            if (!camera || !controls) return; // ì•ˆì „ì¥ì¹˜
            
            gsap.to(camera.position, {
                x: 20, y: 20, z: 20,
                duration: 2,
                ease: "power2.inOut"
            });
            
            gsap.to(controls.target, {
                x: 0, y: 0, z: 0,
                duration: 2,
                ease: "power2.inOut",
                onUpdate: () => controls.update()
            });
            
            updateStatus('ì¹´ë©”ë¼ ìœ„ì¹˜ ë¦¬ì…‹');
        }
        
        // ğŸŒ§ï¸ ë‚ ì”¨ íš¨ê³¼
        let weatherEffect = null;
        function addWeatherEffect() {
            if (!scene) return; // ì•ˆì „ì¥ì¹˜
            
            const particleCount = 1000;
            const geometry = new THREE.BufferGeometry();
            const positions = new Float32Array(particleCount * 3);
            
            for (let i = 0; i < particleCount; i++) {
                positions[i * 3] = (Math.random() - 0.5) * 100;
                positions[i * 3 + 1] = Math.random() * 50;
                positions[i * 3 + 2] = (Math.random() - 0.5) * 100;
            }
            
            geometry.setAttribute('position', new THREE.BufferAttribute(positions, 3));
            
            const material = new THREE.PointsMaterial({
                color: isDay ? 0xffffff : 0x87ceeb,
                size: isDay ? 0.8 : 0.3,
                transparent: true,
                opacity: 0.6
            });
            
            weatherEffect = new THREE.Points(geometry, material);
            scene.add(weatherEffect);
            
            // ë¹„/ëˆˆ ì• ë‹ˆë©”ì´ì…˜
            const animateWeather = () => {
                if (weatherEffect) {
                    const positions = weatherEffect.geometry.attributes.position.array;
                    for (let i = 0; i < positions.length; i += 3) {
                        positions[i + 1] -= isDay ? 0.5 : 0.2; // ë¹„/ëˆˆ ë–¨ì–´ì§€ëŠ” ì†ë„
                        if (positions[i + 1] < -10) {
                            positions[i + 1] = 50;
                        }
                    }
                    weatherEffect.geometry.attributes.position.needsUpdate = true;
                    requestAnimationFrame(animateWeather);
                }
            };
            animateWeather();
        }
        
        function removeWeatherEffect() {
            if (weatherEffect && scene) {
                scene.remove(weatherEffect);
                weatherEffect = null;
            }
        }
        
        // ğŸ“Š ìƒíƒœ ì—…ë°ì´íŠ¸
        function updateStatus(message) {
            console.log(`ğŸ® ${message}`);
            
            // í™”ë©´ì— ì•Œë¦¼ í‘œì‹œ (ì„ íƒì‚¬í•­)
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: rgba(108, 92, 231, 0.9);
                color: white;
                padding: 10px 20px;
                border-radius: 10px;
                z-index: 1000;
                transition: all 0.3s ease;
            `;
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.opacity = '0';
                setTimeout(() => notification.remove(), 300);
            }, 2000);
        }
        
        function updateConversationCount() {
            document.getElementById('conversationCount').textContent = conversationCount;
        }
        
        console.log('ï¿½ğŸŒŒ 5ë‹¨ê³„-B: ì• ë‹ˆë©”ì´ì…˜ ë° ìƒí˜¸ì‘ìš© ì‹œìŠ¤í…œ ì™„ë£Œ!');
        
        // ğŸš€ ìµœì¢… ì´ˆê¸°í™” ì‹¤í–‰ (ES6 ëª¨ë“ˆ ê¸°ë°˜ - ê¸°ì¡´ ì‘ë™ ë°©ì‹ ì ìš©)
        async function initializeUltimateMetaverse() {
            try {
                console.log('ğŸš€ ES6 ëª¨ë“ˆ ê¸°ë°˜ ë©”íƒ€ë²„ìŠ¤ ì´ˆê¸°í™” ì‹œì‘...');
                
                // Three.jsê°€ ES6 ëª¨ë“ˆë¡œ ë¡œë“œë˜ì—ˆìœ¼ë¯€ë¡œ ì¦‰ì‹œ ì‚¬ìš© ê°€ëŠ¥
                // Three.js í™•ì¸ (ES6 ëª¨ë“ˆë¡œ ì´ë¯¸ ë¡œë“œë¨)
                if (typeof THREE === 'undefined') {
                    console.error('âŒ THREE.js ëª¨ë“ˆ ë¡œë”© ì‹¤íŒ¨');
                    createFallbackUI();
                    return;
                }
                
                console.log('âœ… THREE.js ëª¨ë“ˆ í™•ì¸ ì™„ë£Œ');
                
                // 3. ë©”íƒ€ë²„ìŠ¤ 3D í™˜ê²½ ì´ˆê¸°í™”
                initMetaverse();
                console.log('âœ… 3D ë©”íƒ€ë²„ìŠ¤ ì´ˆê¸°í™” ì™„ë£Œ');
                
            } catch (error) {
                console.warn('âš ï¸ 3D ë©”íƒ€ë²„ìŠ¤ ì´ˆê¸°í™” ì‹¤íŒ¨, í´ë°± UI ì‚¬ìš©:', error);
                createFallbackUI();
                return;
            }
            
            // 4. ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì •
            setTimeout(() => {
                try {
                    setupEventListeners();
                    console.log('âœ… ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì • ì™„ë£Œ');
                } catch (e) {
                    console.warn('âš ï¸ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì • ì‹¤íŒ¨:', e);
                }
            }, 100);
            
            // 5. ì• ë‹ˆë©”ì´ì…˜ ì‹œìŠ¤í…œ ì‹œì‘
            setTimeout(() => {
                try {
                    startAnimationSystem();
                    console.log('âœ… ì• ë‹ˆë©”ì´ì…˜ ì‹œìŠ¤í…œ ì‹œì‘ ì™„ë£Œ');
                } catch (e) {
                    console.warn('âš ï¸ ì• ë‹ˆë©”ì´ì…˜ ì‹œìŠ¤í…œ ì‹œì‘ ì‹¤íŒ¨:', e);
                }
            }, 500);
            
            // 6. UI ì—…ë°ì´íŠ¸
            setTimeout(() => {
                try {
                    updateConversationCount();
                    console.log('âœ… UI ì´ˆê¸°í™” ì™„ë£Œ');
                } catch (e) {
                    console.warn('âš ï¸ UI ì´ˆê¸°í™” ì‹¤íŒ¨:', e);
                }
            }, 1000);
            
            // 7. í™˜ì˜ ë©”ì‹œì§€
            setTimeout(() => {
                updateStatus('ğŸŒŸ ê¶ê·¹ì˜ ë„ê¹¨ë¹„ ë©”íƒ€ë²„ìŠ¤ì— ì˜¤ì‹  ê²ƒì„ í™˜ì˜í•©ë‹ˆë‹¤!');
                setTimeout(() => updateStatus('ğŸ’¡ íŒ: ìŠ¤í˜ì´ìŠ¤ë°”(ìë™íšŒì „), T(ì‹œê°„), W(ë‚ ì”¨), R(ë¦¬ì…‹)'), 3000);
                setTimeout(() => updateStatus('ğŸ¯ ë„ê¹¨ë¹„ë¥¼ í´ë¦­í•˜ì—¬ ëŒ€í™”ë¥¼ ì‹œì‘í•˜ì„¸ìš”!'), 6000);
            }, 2000);
        }
        
        // í´ë°± UI ìƒì„±
        function createFallbackUI() {
            const canvas = document.getElementById('metaverse-canvas');
            if (canvas) {
                canvas.innerHTML = `
                    <div style="display: flex; align-items: center; justify-content: center; height: 100%; color: white; text-align: center; flex-direction: column; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                        <h1>ğŸ›ï¸ ë„ê¹¨ë¹„ ë§ˆì„</h1>
                        <p style="margin: 20px 0; font-size: 18px;">16ëª…ì˜ ì „ë¬¸ AI ë„ê¹¨ë¹„ê°€ ì—¬ëŸ¬ë¶„ì„ ê¸°ë‹¤ë¦¬ê³  ìˆìŠµë‹ˆë‹¤!</p>
                        <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; max-width: 600px;">
                            ${goblinDatabase.map(goblin => `
                                <div onclick="openSimpleChat('${goblin.name}')" style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 10px; cursor: pointer; transition: transform 0.2s;" onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">
                                    <div style="font-size: 24px;">${goblin.emoji}</div>
                                    <div style="font-size: 14px; margin-top: 5px;">${goblin.name}</div>
                                </div>
                            `).join('')}
                        </div>
                        <p style="margin-top: 20px; opacity: 0.8;">3D ë¡œë”© ì‹¤íŒ¨ì‹œ ê°„ë‹¨í•œ ë²„ì „ìœ¼ë¡œ ì œê³µë©ë‹ˆë‹¤</p>
                    </div>
                `;
            }
            
            // ê°„ë‹¨í•œ ì±„íŒ… í•¨ìˆ˜
            window.openSimpleChat = function(goblinName) {
                const goblin = goblinDatabase.find(g => g.name === goblinName);
                if (goblin) {
                    openChat(goblin);
                }
            };
        }
        
        // ğŸ”— ë©”ì‹œì§€ í†µì‹  ì‹œìŠ¤í…œ (í…ŒìŠ¤í„° ì—°ë™)
        function setupTestingCommunication() {
            // ë¶€ëª¨ ìœˆë„ìš°ë¡œë¶€í„° ë©”ì‹œì§€ ìˆ˜ì‹ 
            window.addEventListener('message', (event) => {
                console.log('ğŸ“¨ ë©”íƒ€ë²„ìŠ¤ì—ì„œ ë©”ì‹œì§€ ìˆ˜ì‹ :', event.data);
                
                if (event.data.type === 'REQUEST_AI_STATUS') {
                    // AI ìƒíƒœ ì •ë³´ ì „ì†¡
                    const aiInfo = {
                        isActive: isSystemReady,
                        goblinCount: goblins3D.length,
                        memorySize: goblinDatabase.length,
                        knowledgeCategories: 16,
                        systemStatus: 'operational',
                        features: [
                            '16ëª… ì „ë¬¸ ë„ê¹¨ë¹„',
                            '3D ë©”íƒ€ë²„ìŠ¤ í™˜ê²½',
                            'AI ì±„íŒ… ì‹œìŠ¤í…œ',
                            'ì‹¤ì‹œê°„ ìƒí˜¸ì‘ìš©'
                        ]
                    };
                    
                    // ë¶€ëª¨ ìœˆë„ìš°ì— ì‘ë‹µ
                    if (window.parent) {
                        window.parent.postMessage({
                            type: 'AI_AGENT_READY',
                            aiAgent: aiInfo
                        }, '*');
                    }
                    
                    console.log('ğŸ“¤ AI ìƒíƒœ ì •ë³´ ì „ì†¡:', aiInfo);
                }
                
                if (event.data.type === 'REQUEST_PERFORMANCE_DATA') {
                    // ì„±ëŠ¥ ë°ì´í„° ì „ì†¡
                    const performanceData = {
                        fps: Math.floor(Math.random() * 20) + 40, // 40-60 FPS ì‹œë®¬ë ˆì´ì…˜
                        memory: Math.floor(Math.random() * 50) + 100, // 100-150MB ì‹œë®¬ë ˆì´ì…˜
                        renderTime: Math.random() * 10 + 5, // 5-15ms
                        polygonCount: goblins3D.length * 1000,
                        textureMemory: 45
                    };
                    
                    if (window.parent) {
                        window.parent.postMessage({
                            type: 'PERFORMANCE_DATA',
                            data: performanceData
                        }, '*');
                    }
                    
                    console.log('ğŸ“Š ì„±ëŠ¥ ë°ì´í„° ì „ì†¡:', performanceData);
                }
                
                if (event.data.type === 'REQUEST_ENVIRONMENT_STATUS') {
                    // í™˜ê²½ ìƒíƒœ ì •ë³´ ì „ì†¡
                    const environmentStatus = {
                        status: 'ì •ìƒ ì‘ë™',
                        lighting: 'ìµœì í™”ë¨',
                        models: `${goblins3D.length}ê°œ ë¡œë“œ`,
                        animations: 'í™œì„±í™”',
                        physics: 'ì•ˆì •ì '
                    };
                    
                    if (window.parent) {
                        window.parent.postMessage({
                            type: 'ENVIRONMENT_STATUS',
                            data: environmentStatus
                        }, '*');
                    }
                    
                    console.log('ğŸŒ í™˜ê²½ ìƒíƒœ ì „ì†¡:', environmentStatus);
                }
                
                if (event.data.type === 'TEST_CHAT_REQUEST') {
                    // í…ŒìŠ¤íŠ¸ìš© ì±„íŒ… ìš”ì²­ ì²˜ë¦¬
                    const { goblinName, message } = event.data;
                    const goblin = goblinDatabase.find(g => g.name === goblinName);
                    
                    if (goblin) {
                        // ì±„íŒ… ì‹œë®¬ë ˆì´ì…˜
                        console.log(`ğŸ§ª í…ŒìŠ¤íŠ¸ ì±„íŒ…: ${goblinName} - ${message}`);
                        
                        // ì‘ë‹µ ì‹œë®¬ë ˆì´ì…˜
                        setTimeout(() => {
                            const response = generateTestResponse(goblin, message);
                            
                            if (window.parent) {
                                window.parent.postMessage({
                                    type: 'TEST_CHAT_RESPONSE',
                                    data: {
                                        goblinName,
                                        message,
                                        response
                                    }
                                }, '*');
                            }
                        }, 1000);
                    }
                }
            });
            
            console.log('ğŸ”— í…ŒìŠ¤íŒ… í†µì‹  ì‹œìŠ¤í…œ í™œì„±í™”');
        }
        
        // ğŸ§ª í…ŒìŠ¤íŠ¸ ì‘ë‹µ ìƒì„±
        function generateTestResponse(goblin, userMessage) {
            const responses = {
                'ì˜ë£Œ': `${userMessage}ì— ëŒ€í•œ ì˜ë£Œ ì „ë¬¸ ë‹µë³€ì„ ë“œë¦¬ê² ìŠµë‹ˆë‹¤. ê±´ê°• ê´€ë ¨ ì •ë³´ë¥¼ ì œê³µí•©ë‹ˆë‹¤.`,
                'ë¹Œë”': `${userMessage} ê´€ë ¨ ê°œë°œ ì†”ë£¨ì…˜ì„ ì œì•ˆí•˜ê² ìŠµë‹ˆë‹¤. ê¸°ìˆ ì  êµ¬í˜„ ë°©ì•ˆì„ ì•Œë ¤ë“œë¦´ê²Œìš”.`,
                'ìƒë‹´': `${userMessage}ì— ëŒ€í•´ ì „ë¬¸ì ì¸ ìƒë‹´ì„ í•´ë“œë¦¬ê² ìŠµë‹ˆë‹¤. ê°™ì´ í•´ê²°ì±…ì„ ì°¾ì•„ë³´ì•„ìš”.`,
                'ì°½ì‘': `${userMessage}ì— ëŒ€í•œ ì°½ì˜ì ì¸ ì•„ì´ë””ì–´ë¥¼ ì œì•ˆí•´ë“œë¦¬ê² ìŠµë‹ˆë‹¤.`,
                'ë°ì´í„°ë¶„ì„': `${userMessage} ë°ì´í„°ë¥¼ ë¶„ì„í•˜ì—¬ ì¸ì‚¬ì´íŠ¸ë¥¼ ì œê³µí•˜ê² ìŠµë‹ˆë‹¤.`,
                'SEO': `${userMessage} SEO ìµœì í™” ë°©ì•ˆì„ ì•Œë ¤ë“œë¦¬ê² ìŠµë‹ˆë‹¤.`,
                'ë§ˆì¼€íŒ…': `${userMessage} ë§ˆì¼€íŒ… ì „ëµì„ ì œì•ˆí•´ë“œë¦¬ê² ìŠµë‹ˆë‹¤.`,
                'ê¸€ì“°ê¸°': `${userMessage}ì— ëŒ€í•œ ê¸€ì“°ê¸° ë„ì›€ì„ ë“œë¦¬ê² ìŠµë‹ˆë‹¤.`,
                'ì»¨ì„¤íŒ…': `${userMessage} ë¹„ì¦ˆë‹ˆìŠ¤ ì»¨ì„¤íŒ…ì„ í•´ë“œë¦¬ê² ìŠµë‹ˆë‹¤.`,
                'ì¸ì‚¬': `${userMessage} ì¸ì‚¬ ê´€ë¦¬ ì†”ë£¨ì…˜ì„ ì œê³µí•˜ê² ìŠµë‹ˆë‹¤.`,
                'ë¹„ì„œ': `${userMessage} ì—…ë¬´ ì§€ì›ì„ ë„ì™€ë“œë¦¬ê² ìŠµë‹ˆë‹¤.`,
                'ì°½ì—…': `${userMessage} ì°½ì—… ê´€ë ¨ ì¡°ì–¸ì„ ë“œë¦¬ê² ìŠµë‹ˆë‹¤.`,
                'ì‡¼í•‘': `${userMessage} ì‡¼í•‘ ì •ë³´ë¥¼ ì œê³µí•˜ê² ìŠµë‹ˆë‹¤.`,
                'ì„±ì¥': `${userMessage} ì„±ì¥ ë°©í–¥ì„ ì œì‹œí•´ë“œë¦¬ê² ìŠµë‹ˆë‹¤.`,
                'ìš´ì„¸': `${userMessage}ì— ëŒ€í•œ ìš´ì„¸ë¥¼ ë´ë“œë¦¬ê² ìŠµë‹ˆë‹¤.`,
                'ì´Œì¥': `${userMessage}ì— ëŒ€í•´ ë§ˆì„ì˜ ì§€í˜œë¡œ ë‹µë³€ë“œë¦¬ê² ìŠµë‹ˆë‹¤.`
            };
            
            return responses[goblin.name] || `${goblin.name} ë„ê¹¨ë¹„ê°€ ${userMessage}ì— ëŒ€í•´ ë‹µë³€ë“œë¦½ë‹ˆë‹¤.`;
        }
        
        // DOM ë¡œë“œ ì™„ë£Œ í›„ ì‹¤í–‰
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializeUltimateMetaverse);
        } else {
            // ì•½ê°„ì˜ ì§€ì—°ì„ ì£¼ì–´ ìŠ¤í¬ë¦½íŠ¸ ë¡œë“œ ì™„ë£Œ ëŒ€ê¸°
            setTimeout(() => {
                initializeUltimateMetaverse();
                // ì´ˆê¸°í™” ì™„ë£Œ í›„ í†µì‹  ì‹œìŠ¤í…œ í™œì„±í™”
                setTimeout(setupTestingCommunication, 2000);
            }, 100);
        }
        
        console.log('ğŸ‰ ë„ê¹¨ë¹„ ë©”íƒ€ë²„ìŠ¤ ê¶ê·¹ ë²„ì „ ì™„ì„±! ëª¨ë“  ì‹œìŠ¤í…œ ê°€ë™ ì¤‘...');
    </script>
</body>
</html>
