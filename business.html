<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ¢ ë¹„ì¦ˆë‹ˆìŠ¤ êµ¬ì—­ - ë„ê¹¨ë¹„ ë©”íƒ€ë²„ìŠ¤</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            overflow: hidden;
        }
        
        #business-canvas {
            display: block;
            width: 100vw;
            height: 100vh;
            cursor: crosshair;
        }
        
        /* ë©”ì¸ UI ì»¨í…Œì´ë„ˆ */
        .ui-container {
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 1000;
            pointer-events: none;
        }
        
        .ui-container > * {
            pointer-events: auto;
        }
        
        /* ìƒíƒœ í‘œì‹œ */
        .status-display {
            background: rgba(52, 73, 94, 0.9);
            border: 2px solid #3498db;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            font-size: 14px;
            backdrop-filter: blur(10px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
        
        /* ì»¨íŠ¸ë¡¤ íŒ¨ë„ */
        .control-panel {
            background: rgba(52, 73, 94, 0.95);
            border: 2px solid #3498db;
            border-radius: 15px;
            padding: 20px;
            backdrop-filter: blur(10px);
            box-shadow: 0 5px 20px rgba(0,0,0,0.4);
            min-width: 300px;
        }
        
        .control-btn {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            border: none;
            border-radius: 8px;
            color: white;
            padding: 12px 16px;
            margin: 5px;
            cursor: pointer;
            font-size: 13px;
            font-weight: 600;
            transition: all 0.3s ease;
            width: 100%;
            text-align: center;
        }
        
        .control-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.4);
        }
        
        /* ë’¤ë¡œê°€ê¸° ë²„íŠ¼ */
        .back-btn {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1001;
            border: none;
            border-radius: 10px;
            color: white;
            padding: 15px 20px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        
        .back-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 107, 107, 0.4);
        }
        
        /* ë¹„ì¦ˆë‹ˆìŠ¤ ë„ê¹¨ë¹„ ì¹´ë“œ */
        .business-goblin-card {
            background: rgba(44, 62, 80, 0.9);
            border: 2px solid #3498db;
            border-radius: 15px;
            padding: 15px;
            margin: 10px 0;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }
        
        .business-goblin-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(52, 152, 219, 0.3);
            border-color: #5dade2;
        }
        
        .goblin-name {
            font-size: 18px;
            font-weight: bold;
            color: #3498db;
            margin-bottom: 8px;
        }
        
        .goblin-specialty {
            font-size: 14px;
            color: #85c1e9;
            margin-bottom: 5px;
        }

        /* ğŸ¢ ë¹„ì¦ˆë‹ˆìŠ¤ ì±„íŒ… ì‹œìŠ¤í…œ */
        .chat-container {
            position: fixed;
            top: 20px;
            right: 20px;
            width: 350px;
            height: 500px;
            background: linear-gradient(135deg, rgba(44, 62, 80, 0.95), rgba(52, 152, 219, 0.95));
            border: 2px solid #3498db;
            border-radius: 15px;
            display: none;
            flex-direction: column;
            backdrop-filter: blur(15px);
            box-shadow: 0 10px 30px rgba(52, 152, 219, 0.3);
            z-index: 1000;
        }

        .chat-header {
            background: linear-gradient(90deg, #2c3e50, #3498db);
            color: white;
            padding: 15px;
            border-radius: 13px 13px 0 0;
            font-weight: bold;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 2px solid #3498db;
        }

        .chat-close {
            background: none;
            border: none;
            color: #3498db;
            font-size: 20px;
            cursor: pointer;
            padding: 0;
            width: 25px;
            height: 25px;
            border-radius: 50%;
            transition: all 0.3s ease;
        }

        .chat-close:hover {
            background: rgba(52, 152, 219, 0.2);
        }

        .chat-messages {
            flex: 1;
            padding: 15px;
            overflow-y: auto;
            background: rgba(44, 62, 80, 0.8);
        }

        .message {
            margin: 10px 0;
            display: flex;
            align-items: flex-start;
            gap: 10px;
        }

        .message.user-message {
            flex-direction: row-reverse;
        }

        .message .avatar {
            min-width: 35px;
            height: 35px;
            border-radius: 50%;
            background: linear-gradient(135deg, #3498db, #5dade2);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
        }

        .message.user-message .avatar {
            background: linear-gradient(135deg, #2980b9, #74b9ff);
        }

        .message .text {
            background: rgba(52, 152, 219, 0.3);
            padding: 10px 15px;
            border-radius: 15px;
            max-width: 250px;
            word-wrap: break-word;
            border: 1px solid rgba(52, 152, 219, 0.3);
            color: #ecf0f1;
        }

        .message.user-message .text {
            background: rgba(74, 144, 226, 0.3);
            border-color: rgba(93, 173, 226, 0.3);
        }

        .chat-input-container {
            padding: 15px;
            border-top: 1px solid rgba(52, 152, 219, 0.3);
            background: rgba(44, 62, 80, 0.9);
            border-radius: 0 0 13px 13px;
        }

        .chat-input {
            width: 100%;
            padding: 10px;
            border: 2px solid #3498db;
            border-radius: 20px;
            background: rgba(44, 62, 80, 0.8);
            color: #ecf0f1;
            font-size: 14px;
            outline: none;
            transition: all 0.3s ease;
        }

        .chat-input:focus {
            border-color: #5dade2;
            box-shadow: 0 0 10px rgba(52, 152, 219, 0.3);
        }

        .chat-input::placeholder {
            color: #85c1e9;
        }
    </style>
</head>
<body>
    <!-- ë’¤ë¡œê°€ê¸° ë²„íŠ¼ -->
    <button class="back-btn" onclick="goBackToVillage()">â† ğŸ˜ï¸ ë„ê¹¨ë¹„ ë§ˆì„ë¡œ</button>
    
    <!-- ë©”ì¸ ìº”ë²„ìŠ¤ -->
    <canvas id="business-canvas"></canvas>
    
    <!-- UI ì»¨í…Œì´ë„ˆ -->
    <div class="ui-container">
        <!-- ìƒíƒœ í‘œì‹œ -->
        <div class="status-display" id="statusDisplay">
            ğŸ¢ ë¹„ì¦ˆë‹ˆìŠ¤ êµ¬ì—­ì— ì˜¤ì‹  ê²ƒì„ í™˜ì˜í•©ë‹ˆë‹¤!
        </div>
        
        <!-- ğŸ¢ ì±„íŒ… ì‹œìŠ¤í…œ -->
        <div class="chat-container" id="chatContainer">
            <div class="chat-header">
                <span id="chatTitle">ğŸ¢ ë¹„ì¦ˆë‹ˆìŠ¤ ë„ê¹¨ë¹„ì™€ì˜ ëŒ€í™”</span>
                <button class="chat-close" onclick="closeChat()">Ã—</button>
            </div>
            <div class="chat-messages" id="chatMessages"></div>
            <div class="chat-input-container">
                <input type="text" class="chat-input" id="chatInput" 
                       placeholder="ë¹„ì¦ˆë‹ˆìŠ¤ì— ëŒ€í•´ ì§ˆë¬¸í•´ë³´ì„¸ìš”..." 
                       onkeypress="handleChatKeyPress(event)">
            </div>
        </div>
        
        <!-- ì»¨íŠ¸ë¡¤ íŒ¨ë„ -->
        <div class="control-panel">
            <h2 style="color: #3498db; margin-bottom: 15px; text-align: center;">ğŸ¢ ë¹„ì¦ˆë‹ˆìŠ¤ êµ¬ì—­</h2>
            
            <div style="margin-bottom: 20px;">
                <h3 style="color: #3498db; margin-bottom: 10px; font-size: 16px;">ğŸ® ì»¨íŠ¸ë¡¤</h3>
                <button class="control-btn" onclick="toggleAvatar()">ğŸš¶â€â™‚ï¸ ì•„ë°”íƒ€ ì†Œí™˜</button>
                <button class="control-btn" onclick="resetCamera()">ğŸ“· ì¹´ë©”ë¼ ë¦¬ì…‹</button>
                <button class="control-btn" onclick="toggleLighting()">ğŸ’¡ ì¡°ëª… ë³€ê²½</button>
            </div>
            
            <div style="margin-bottom: 20px;">
                <h3 style="color: #3498db; margin-bottom: 10px; font-size: 16px;">ğŸ’¼ ë¹„ì¦ˆë‹ˆìŠ¤ ë„ê¹¨ë¹„ë“¤</h3>
                <div id="businessGoblinGrid">
                    <!-- ë¹„ì¦ˆë‹ˆìŠ¤ ë„ê¹¨ë¹„ë“¤ì´ ì—¬ê¸°ì— ìƒì„±ë©ë‹ˆë‹¤ -->
                </div>
            </div>
        </div>
    </div>
    
    <!-- Three.js ë° GSAP ë¼ì´ë¸ŒëŸ¬ë¦¬ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    
    <script>
        // ğŸ¢ ë¹„ì¦ˆë‹ˆìŠ¤ êµ¬ì—­ ì „ì—­ ë³€ìˆ˜
        let scene, camera, renderer, controls;
        let currentChatGoblin = null; // ğŸ¢ í˜„ì¬ ì±„íŒ… ì¤‘ì¸ ë„ê¹¨ë¹„
        let avatar = null;
        let isSystemReady = false;
        
        // ğŸ’¼ ë¹„ì¦ˆë‹ˆìŠ¤ ì „ë¬¸ ë„ê¹¨ë¹„ë“¤
        const businessGoblins = [
            { name: 'ğŸ’° íˆ¬ìë§ˆë²•ì‚¬', specialty: 'íˆ¬ì ì „ëµ', description: 'ìµœê³ ì˜ íˆ¬ì ê¸°íšŒë¥¼ ì°¾ì•„ë‚´ëŠ” ë„ê¹¨ë¹„', emoji: 'ğŸ’°', color: 0xFFD700 },
            { name: 'ğŸ“Š ë°ì´í„°ë¶„ì„ê´€', specialty: 'ë¹„ì¦ˆë‹ˆìŠ¤ ë¶„ì„', description: 'ë³µì¡í•œ ë°ì´í„°ë¥¼ ëª…ì¾Œí•˜ê²Œ ë¶„ì„í•˜ëŠ” ë„ê¹¨ë¹„', emoji: 'ğŸ“Š', color: 0x1E90FF },
            { name: 'ğŸ¯ ë§ˆì¼€íŒ…ì²œì¬', specialty: 'ë§ˆì¼€íŒ… ì „ëµ', description: 'ë¸Œëœë“œë¥¼ ì„¸ê³„ì ìœ¼ë¡œ ì•Œë¦¬ëŠ” ë§ˆì¼€íŒ… ë„ê¹¨ë¹„', emoji: 'ğŸ¯', color: 0xFF6347 },
            { name: 'âš–ï¸ ë²•ë¬´ì»¨ì„¤í„´íŠ¸', specialty: 'ë²•ë¬´ ìë¬¸', description: 'ëª¨ë“  ë²•ì  ë¬¸ì œë¥¼ í•´ê²°í•˜ëŠ” ì§€í˜œë¡œìš´ ë„ê¹¨ë¹„', emoji: 'âš–ï¸', color: 0x4B0082 },
            { name: 'ğŸ—ï¸ ì‚¬ì—…ì„¤ê³„ì‚¬', specialty: 'ì‚¬ì—… ê¸°íš', description: 'ì„±ê³µí•˜ëŠ” ì‚¬ì—… ëª¨ë¸ì„ ì„¤ê³„í•˜ëŠ” ë„ê¹¨ë¹„', emoji: 'ğŸ—ï¸', color: 0x228B22 },
            { name: 'ğŸ¤ í˜‘ìƒì „ë¬¸ê°€', specialty: 'í˜‘ìƒ ê¸°ìˆ ', description: 'ìœˆ-ìœˆ í˜‘ìƒì„ ì´ëŒì–´ë‚´ëŠ” ë„ê¹¨ë¹„', emoji: 'ğŸ¤', color: 0xFF1493 }
        ];
        
        // ğŸ¯ ìƒíƒœ ì—…ë°ì´íŠ¸ í•¨ìˆ˜
        function updateStatus(message) {
            const statusElement = document.getElementById('statusDisplay');
            if (statusElement) {
                statusElement.textContent = message;
            }
        }
        
        // ğŸ”™ ë„ê¹¨ë¹„ ë§ˆì„ë¡œ ëŒì•„ê°€ê¸°
        function goBackToVillage() {
            updateStatus('ğŸ˜ï¸ ë„ê¹¨ë¹„ ë§ˆì„ë¡œ ëŒì•„ê°€ëŠ” ì¤‘...');
            // GitHub Pagesìš© ë² ì´ìŠ¤ URL ê³„ì‚°
            const baseURL = window.location.origin + window.location.pathname.replace(/\/[^\/]*$/, '/');
            setTimeout(() => {
                window.location.href = baseURL + 'index.html';
            }, 1000);
        }
        
        // ğŸ® ì•„ë°”íƒ€ í† ê¸€
        function toggleAvatar() {
            if (!avatar) {
                createAvatar();
            } else {
                removeAvatar();
            }
        }
        
        // ğŸš¶â€â™‚ï¸ ì•„ë°”íƒ€ ìƒì„±
        function createAvatar() {
            avatar = new THREE.Group();
            
            // ë¹„ì¦ˆë‹ˆìŠ¤ë§¨ ì •ì¥ (ëª¸í†µ)
            const bodyGeometry = new THREE.CylinderGeometry(0.3, 0.4, 1.5);
            const bodyMaterial = new THREE.MeshPhongMaterial({ color: 0x2c3e50 });
            const body = new THREE.Mesh(bodyGeometry, bodyMaterial);
            body.position.y = 1;
            avatar.add(body);
            
            // ë¨¸ë¦¬
            const headGeometry = new THREE.SphereGeometry(0.4);
            const headMaterial = new THREE.MeshPhongMaterial({ color: 0xf4d1ae });
            const head = new THREE.Mesh(headGeometry, headMaterial);
            head.position.y = 2.2;
            avatar.add(head);
            
            // ì •ì¥ íƒ€ì´
            const tieGeometry = new THREE.BoxGeometry(0.1, 0.8, 0.05);
            const tieMaterial = new THREE.MeshPhongMaterial({ color: 0x8b0000 });
            const tie = new THREE.Mesh(tieGeometry, tieMaterial);
            tie.position.set(0, 1.2, 0.4);
            avatar.add(tie);
            
            // ì„œë¥˜ê°€ë°©
            const briefcaseGeometry = new THREE.BoxGeometry(0.6, 0.4, 0.2);
            const briefcaseMaterial = new THREE.MeshPhongMaterial({ color: 0x8b4513 });
            const briefcase = new THREE.Mesh(briefcaseGeometry, briefcaseMaterial);
            briefcase.position.set(0.8, 0.8, 0);
            avatar.add(briefcase);
            
            // ë¹„ì¦ˆë‹ˆìŠ¤ ì˜¤ë¼
            const auraGeometry = new THREE.RingGeometry(0.8, 1.2, 16);
            const auraMaterial = new THREE.MeshBasicMaterial({ 
                color: 0x3498db, 
                transparent: true, 
                opacity: 0.3,
                side: THREE.DoubleSide
            });
            const aura = new THREE.Mesh(auraGeometry, auraMaterial);
            aura.rotation.x = -Math.PI / 2;
            aura.position.y = 0.1;
            avatar.add(aura);
            
            gsap.to(aura.rotation, {
                z: Math.PI * 2,
                duration: 4,
                repeat: -1,
                ease: "none"
            });
            
            avatar.position.set(0, 0, 0);
            scene.add(avatar);
            
            if (camera && controls) {
                gsap.to(camera.position, {
                    x: 5, y: 5, z: 10,
                    duration: 1.5,
                    ease: "power2.out"
                });
                gsap.to(controls.target, {
                    x: 0, y: 1, z: 0,
                    duration: 1.5,
                    ease: "power2.out",
                    onUpdate: () => controls.update()
                });
            }
            
            updateStatus('ğŸš¶â€â™‚ï¸ ë¹„ì¦ˆë‹ˆìŠ¤ë§¨ ì•„ë°”íƒ€ê°€ ì†Œí™˜ë˜ì—ˆìŠµë‹ˆë‹¤!');
        }
        
        // ğŸš¶â€â™‚ï¸ ì•„ë°”íƒ€ ì œê±°
        function removeAvatar() {
            if (avatar) {
                while(avatar.children.length > 0) {
                    const child = avatar.children[0];
                    avatar.remove(child);
                    if (child.geometry) child.geometry.dispose();
                    if (child.material) child.material.dispose();
                }
                scene.remove(avatar);
                avatar = null;
                updateStatus('ğŸ‘‹ ì•„ë°”íƒ€ê°€ ì‚¬ë¼ì¡ŒìŠµë‹ˆë‹¤');
            }
        }
        
        // ğŸ“· ì¹´ë©”ë¼ ë¦¬ì…‹
        function resetCamera() {
            if (camera && controls) {
                gsap.to(camera.position, {
                    x: 0, y: 15, z: 25,
                    duration: 1.5,
                    ease: "power2.out"
                });
                gsap.to(controls.target, {
                    x: 0, y: 0, z: 0,
                    duration: 1.5,
                    ease: "power2.out",
                    onUpdate: () => controls.update()
                });
                updateStatus('ğŸ“· ì¹´ë©”ë¼ê°€ ë¹„ì¦ˆë‹ˆìŠ¤ êµ¬ì—­ ì¤‘ì‹¬ìœ¼ë¡œ ë¦¬ì…‹ë˜ì—ˆìŠµë‹ˆë‹¤');
            }
        }
        
        // ğŸ’¡ ì¡°ëª… ë³€ê²½
        function toggleLighting() {
            const lightings = ['â˜€ï¸ ë‚®', 'ğŸŒ™ ë°¤', 'ğŸ’¡ ë„¤ì˜¨', 'ğŸ”¥ ë”°ëœ»í•¨'];
            const randomLighting = lightings[Math.floor(Math.random() * lightings.length)];
            updateStatus(`ğŸ¢ ë¹„ì¦ˆë‹ˆìŠ¤ êµ¬ì—­ ì¡°ëª…ì´ ${randomLighting}ë¡œ ë³€í–ˆìŠµë‹ˆë‹¤`);
        }
        
        // ğŸ·ï¸ ë¹„ì¦ˆë‹ˆìŠ¤ ë„ê¹¨ë¹„ ì´ë¦„í‘œ ìƒì„±
        function createBusinessGoblinNameTag(name, specialty) {
            const canvas = document.createElement('canvas');
            const context = canvas.getContext('2d');
            canvas.width = 512;
            canvas.height = 256;
            
            // ë¹„ì¦ˆë‹ˆìŠ¤ ìŠ¤íƒ€ì¼ ë°°ê²½
            context.fillStyle = 'rgba(44, 62, 80, 0.9)';
            context.fillRect(0, 0, canvas.width, canvas.height);
            
            // í”„ë¡œí˜ì…”ë„í•œ í…Œë‘ë¦¬
            context.strokeStyle = '#3498db';
            context.lineWidth = 8;
            context.strokeRect(4, 4, canvas.width - 8, canvas.height - 8);
            
            // ì´ë¦„ í…ìŠ¤íŠ¸
            context.fillStyle = '#3498db';
            context.font = 'bold 48px Arial';
            context.textAlign = 'center';
            context.fillText(name, canvas.width / 2, 80);
            
            // ì „ë¬¸ ë¶„ì•¼ í…ìŠ¤íŠ¸
            context.fillStyle = '#85c1e9';
            context.font = '32px Arial';
            context.fillText(specialty, canvas.width / 2, 140);
            
            // í”„ë¡œí˜ì…”ë„ ë¼ì¸
            context.strokeStyle = '#3498db';
            context.lineWidth = 2;
            context.beginPath();
            context.moveTo(50, 160);
            context.lineTo(canvas.width - 50, 160);
            context.stroke();
            
            // ë‹¤ì´ì•„ëª¬ë“œ ì¥ì‹ë“¤
            context.fillStyle = '#5dade2';
            for (let i = 0; i < 5; i++) {
                const x = 80 + i * 90;
                const y = 200;
                context.save();
                context.translate(x, y);
                context.rotate(Math.PI / 4);
                context.fillRect(-6, -6, 12, 12);
                context.restore();
            }
            
            const texture = new THREE.CanvasTexture(canvas);
            texture.needsUpdate = true;
            
            const planeGeometry = new THREE.PlaneGeometry(4, 2);
            const planeMaterial = new THREE.MeshBasicMaterial({ 
                map: texture, 
                transparent: true,
                side: THREE.DoubleSide
            });
            
            const nameTagMesh = new THREE.Mesh(planeGeometry, planeMaterial);
            nameTagMesh.userData.isNameTag = true;
            
            return nameTagMesh;
        }
        
        // ğŸ’¼ 3D ë¹„ì¦ˆë‹ˆìŠ¤ ë„ê¹¨ë¹„ë“¤ ìƒì„±
        function createBusiness3DGoblins() {
            businessGoblins.forEach((goblin, index) => {
                const goblin3D = createBusiness3DGoblin(goblin, index);
                scene.add(goblin3D);
            });
        }
        
        // ğŸ’¼ ê°œë³„ 3D ë¹„ì¦ˆë‹ˆìŠ¤ ë„ê¹¨ë¹„ ìƒì„±
        function createBusiness3DGoblin(goblinData, index) {
            const goblinGroup = new THREE.Group();
            
            // ë„ê¹¨ë¹„ ëª¸ì²´ (ì •ì¥ ìŠ¤íƒ€ì¼)
            const bodyGeometry = new THREE.CylinderGeometry(0.8, 1, 2);
            const bodyMaterial = new THREE.MeshPhongMaterial({ 
                color: goblinData.color,
                shininess: 100
            });
            const body = new THREE.Mesh(bodyGeometry, bodyMaterial);
            body.position.y = 1;
            goblinGroup.add(body);
            
            // ì •ì¥ ì–´ê¹¨
            const shoulderGeometry = new THREE.BoxGeometry(2.2, 0.3, 1.2);
            const shoulderMaterial = new THREE.MeshPhongMaterial({ color: 0x2c3e50 });
            const shoulder = new THREE.Mesh(shoulderGeometry, shoulderMaterial);
            shoulder.position.y = 1.8;
            goblinGroup.add(shoulder);
            
            // ë„ê¹¨ë¹„ ë¨¸ë¦¬
            const headGeometry = new THREE.SphereGeometry(0.6);
            const headMaterial = new THREE.MeshPhongMaterial({ color: 0xf4d1ae });
            const head = new THREE.Mesh(headGeometry, headMaterial);
            head.position.y = 2.8;
            goblinGroup.add(head);
            
            // ì•ˆê²½
            const glassGeometry = new THREE.RingGeometry(0.15, 0.25, 16);
            const glassMaterial = new THREE.MeshBasicMaterial({ color: 0x000000 });
            const leftGlass = new THREE.Mesh(glassGeometry, glassMaterial);
            leftGlass.position.set(-0.2, 2.8, 0.5);
            goblinGroup.add(leftGlass);
            
            const rightGlass = new THREE.Mesh(glassGeometry, glassMaterial);
            rightGlass.position.set(0.2, 2.8, 0.5);
            goblinGroup.add(rightGlass);
            
            // ëª¨ì (ë¹„ì¦ˆë‹ˆìŠ¤ í–‡)
            const hatGeometry = new THREE.CylinderGeometry(0.8, 0.8, 0.3);
            const hatMaterial = new THREE.MeshPhongMaterial({ color: 0x2c3e50 });
            const hat = new THREE.Mesh(hatGeometry, hatMaterial);
            hat.position.y = 3.5;
            goblinGroup.add(hat);
            
            // ë¹„ì¦ˆë‹ˆìŠ¤ ì˜¤ë¼
            const auraGeometry = new THREE.RingGeometry(2, 2.5, 16);
            const auraMaterial = new THREE.MeshBasicMaterial({ 
                color: goblinData.color,
                transparent: true,
                opacity: 0.2,
                side: THREE.DoubleSide
            });
            const aura = new THREE.Mesh(auraGeometry, auraMaterial);
            aura.rotation.x = -Math.PI / 2;
            aura.position.y = 0.1;
            goblinGroup.add(aura);
            
            // ì´ë¦„í‘œ ì¶”ê°€
            const nameTag = createBusinessGoblinNameTag(goblinData.name, goblinData.specialty);
            nameTag.position.set(0, 5, 0);
            goblinGroup.add(nameTag);
            
            // ìœ„ì¹˜ ì„¤ì • (ìœ¡ê°í˜• ë°°ì¹˜)
            const angle = (index / businessGoblins.length) * Math.PI * 2;
            const radius = 18;
            const x = Math.cos(angle) * radius;
            const z = Math.sin(angle) * radius;
            goblinGroup.position.set(x, 0, z);
            
            goblinGroup.lookAt(0, 1, 0);
            
            goblinGroup.userData = {
                goblinData: goblinData,
                index: index,
                isBusinessGoblin: true
            };
            
            // í”„ë¡œí˜ì…”ë„í•œ ì• ë‹ˆë©”ì´ì…˜
            gsap.to(goblinGroup.position, {
                y: Math.sin(index) * 0.3,
                duration: 4 + index * 0.3,
                repeat: -1,
                yoyo: true,
                ease: "sine.inOut"
            });
            
            gsap.to(aura.rotation, {
                z: Math.PI * 2,
                duration: 5 + index,
                repeat: -1,
                ease: "none"
            });
            
            return goblinGroup;
        }
        
        // ğŸ’¼ ë¹„ì¦ˆë‹ˆìŠ¤ ë„ê¹¨ë¹„ í´ë¦­ ì²˜ë¦¬
        function onBusinessCanvasClick(event) {
            if (!camera || !scene) return;
            
            const rect = renderer.domElement.getBoundingClientRect();
            const mouse = new THREE.Vector2();
            mouse.x = ((event.clientX - rect.left) / rect.width) * 2 - 1;
            mouse.y = -((event.clientY - rect.top) / rect.height) * 2 + 1;
            
            const raycaster = new THREE.Raycaster();
            raycaster.setFromCamera(mouse, camera);
            
            const intersects = raycaster.intersectObjects(scene.children, true);
            
            if (intersects.length > 0) {
                let clickedObject = intersects[0].object;
                
                while (clickedObject && !clickedObject.userData.isBusinessGoblin) {
                    clickedObject = clickedObject.parent;
                }
                
                if (clickedObject && clickedObject.userData.isBusinessGoblin) {
                    const goblinData = clickedObject.userData.goblinData;
                    selectBusinessGoblin(goblinData);
                    
                    gsap.to(clickedObject.scale, {
                        x: 1.2, y: 1.2, z: 1.2,
                        duration: 0.2,
                        yoyo: true,
                        repeat: 1,
                        ease: "power2.out"
                    });
                }
            }
        }
        
        // ğŸ’¼ ë¹„ì¦ˆë‹ˆìŠ¤ ë„ê¹¨ë¹„ ì¹´ë“œ ìƒì„±
        function createBusinessGoblinCards() {
            const gridElement = document.getElementById('businessGoblinGrid');
            
            businessGoblins.forEach((goblin, index) => {
                const card = document.createElement('div');
                card.className = 'business-goblin-card';
                card.onclick = () => selectBusinessGoblin(goblin);
                
                card.innerHTML = `
                    <div class="goblin-name">${goblin.name}</div>
                    <div class="goblin-specialty">${goblin.specialty}</div>
                    <div style="font-size: 12px; color: #aed6f1;">${goblin.description}</div>
                `;
                
                gridElement.appendChild(card);
            });
        }
        
        // ğŸ’¼ ë¹„ì¦ˆë‹ˆìŠ¤ ë„ê¹¨ë¹„ ì„ íƒ
        function selectBusinessGoblin(goblin) {
            updateStatus(`ğŸ’¼ ${goblin.name}ê³¼ ë¹„ì¦ˆë‹ˆìŠ¤ ë¯¸íŒ…ì„ ì‹œì‘í•©ë‹ˆë‹¤!`);
            console.log('ì„ íƒëœ ë¹„ì¦ˆë‹ˆìŠ¤ ë„ê¹¨ë¹„:', goblin);
            
            // ğŸ¢ ì±„íŒ… ì‹œìŠ¤í…œ ì—´ê¸°
            openChat(goblin);
            
            setTimeout(() => {
                updateStatus(`ğŸ¢ ${goblin.name}: "${goblin.description}"`);
            }, 1500);
        }

        // ğŸ¢ ì±„íŒ… ì‹œìŠ¤í…œ ì—´ê¸°
        function openChat(goblin) {
            currentChatGoblin = goblin;
            
            const chatContainer = document.getElementById('chatContainer');
            const chatTitle = document.getElementById('chatTitle');
            const chatMessages = document.getElementById('chatMessages');
            
            chatTitle.textContent = `ğŸ¢ ${goblin.name}ê³¼ì˜ ë¹„ì¦ˆë‹ˆìŠ¤ ëŒ€í™”`;
            chatMessages.innerHTML = `
                <div class="message goblin-message">
                    <div class="avatar">ğŸ¢</div>
                    <div class="text">${goblin.name}: ì•ˆë…•í•˜ì„¸ìš”! ë¹„ì¦ˆë‹ˆìŠ¤ êµ¬ì—­ì— ì˜¤ì‹  ê²ƒì„ í™˜ì˜í•©ë‹ˆë‹¤. ì–´ë–¤ ë¹„ì¦ˆë‹ˆìŠ¤ ì£¼ì œì— ëŒ€í•´ ì´ì•¼ê¸°í•˜ê³  ì‹¶ìœ¼ì‹ ê°€ìš”? ğŸ’¼âœ¨</div>
                </div>
            `;
            
            chatContainer.style.display = 'flex';
            document.getElementById('chatInput').focus();
        }

        // ğŸ¢ ì±„íŒ… ì‹œìŠ¤í…œ ë‹«ê¸°
        function closeChat() {
            document.getElementById('chatContainer').style.display = 'none';
            currentChatGoblin = null;
        }

        // ğŸ¢ ì±„íŒ… ì…ë ¥ ì²˜ë¦¬
        function handleChatKeyPress(event) {
            if (event.key === 'Enter') {
                sendChatMessage();
            }
        }

        // ğŸ¢ ì±„íŒ… ë©”ì‹œì§€ ì „ì†¡
        function sendChatMessage() {
            const chatInput = document.getElementById('chatInput');
            const message = chatInput.value.trim();
            
            if (message && currentChatGoblin) {
                const chatMessages = document.getElementById('chatMessages');
                
                // ì‚¬ìš©ì ë©”ì‹œì§€ ì¶”ê°€
                chatMessages.innerHTML += `
                    <div class="message user-message">
                        <div class="text">${message}</div>
                        <div class="avatar">ğŸ‘¤</div>
                    </div>
                `;
                
                // ë„ê¹¨ë¹„ ì‘ë‹µ ìƒì„±
                const response = generateBusinessGoblinResponse(currentChatGoblin, message);
                
                setTimeout(() => {
                    chatMessages.innerHTML += `
                        <div class="message goblin-message">
                            <div class="avatar">ğŸ¢</div>
                            <div class="text">${currentChatGoblin.name}: ${response}</div>
                        </div>
                    `;
                    chatMessages.scrollTop = chatMessages.scrollHeight;
                }, 1000);
                
                chatInput.value = '';
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }
        }

        // ğŸ¢ ë¹„ì¦ˆë‹ˆìŠ¤ ë„ê¹¨ë¹„ AI ì‘ë‹µ ìƒì„±
        function generateBusinessGoblinResponse(goblin, userMessage) {
            const message = userMessage.toLowerCase();
            
            // ë¹„ì¦ˆë‹ˆìŠ¤ ë¶„ì•¼ë³„ ì „ë¬¸ ì‘ë‹µ
            if (goblin.name === 'ê²½ì˜ì „ëµê°€') {
                if (message.includes('ì „ëµ') || message.includes('ê²½ì˜') || message.includes('ê³„íš')) {
                    return "ì„±ê³µì ì¸ ê²½ì˜ ì „ëµì€ ëª…í™•í•œ ë¹„ì „ê³¼ ì‹¤í–‰ ê°€ëŠ¥í•œ ê³„íšì—ì„œ ì‹œì‘ë©ë‹ˆë‹¤. SWOT ë¶„ì„ì„ í†µí•´ ê°•ì ì„ ê·¹ëŒ€í™”í•˜ê³  ê¸°íšŒë¥¼ í¬ì°©í•˜ì„¸ìš”! ğŸ“ŠğŸ’¡";
                } else if (message.includes('ë¦¬ë”ì‹­') || message.includes('íŒ€') || message.includes('ê´€ë¦¬')) {
                    return "í›Œë¥­í•œ ë¦¬ë”ëŠ” ë¹„ì „ì„ ì œì‹œí•˜ê³  íŒ€ì„ ë™ê¸°ë¶€ì—¬í•©ë‹ˆë‹¤. ë³€í™”í•˜ëŠ” ì‹œëŒ€ì—ëŠ” ì ì‘ë ¥ê³¼ ì†Œí†µ ëŠ¥ë ¥ì´ í•µì‹¬ì´ì£ ! ğŸ‘¥ğŸŒŸ";
                } else if (message.includes('í˜ì‹ ') || message.includes('ë³€í™”')) {
                    return "í˜ì‹ ì€ ê¸°ì¡´ì˜ í‹€ì„ ê¹¨ê³  ìƒˆë¡œìš´ ê°€ì¹˜ë¥¼ ì°½ì¶œí•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ê³ ê°ì˜ ë‹ˆì¦ˆë¥¼ íŒŒì•…í•˜ê³  ì‹œì¥ì˜ ë³€í™”ë¥¼ ì½ì–´ë³´ì„¸ìš”! ğŸš€ğŸ’­";
                }
            } else if (goblin.name === 'ë§ˆì¼€íŒ…ëŒ€ì™•') {
                if (message.includes('ë§ˆì¼€íŒ…') || message.includes('ê´‘ê³ ') || message.includes('ë¸Œëœë“œ')) {
                    return "ë§ˆì¼€íŒ…ì€ ê³ ê°ê³¼ì˜ ê°ì •ì  ì—°ê²°ì…ë‹ˆë‹¤! íƒ€ê²Ÿ ê³ ê°ì„ ì •í™•íˆ íŒŒì•…í•˜ê³  ê·¸ë“¤ì˜ ë§ˆìŒì— ë‹¿ëŠ” ë©”ì‹œì§€ë¥¼ ì „ë‹¬í•˜ì„¸ìš”. ğŸ¯â¤ï¸";
                } else if (message.includes('sns') || message.includes('ì†Œì…œë¯¸ë””ì–´') || message.includes('ë””ì§€í„¸')) {
                    return "ë””ì§€í„¸ ë§ˆì¼€íŒ… ì‹œëŒ€ì—ëŠ” ì½˜í…ì¸ ê°€ ì™•ì…ë‹ˆë‹¤! ì¸ìŠ¤íƒ€ê·¸ë¨, í‹±í†¡, ìœ íŠœë¸Œì—ì„œ ë°”ì´ëŸ´ ì½˜í…ì¸ ë¥¼ ë§Œë“¤ì–´ë³´ì„¸ìš”. ğŸ“±âœ¨";
                } else if (message.includes('ê³ ê°') || message.includes('ë¸Œëœë”©')) {
                    return "ê°•ë ¥í•œ ë¸Œëœë“œëŠ” ê³ ê°ì˜ ë¼ì´í”„ìŠ¤íƒ€ì¼ì— ë…¹ì•„ë“­ë‹ˆë‹¤. ë¸Œëœë“œ ìŠ¤í† ë¦¬í…”ë§ìœ¼ë¡œ ê³ ê°ê³¼ ê¹Šì€ ìœ ëŒ€ê°ì„ ë§Œë“¤ì–´ë³´ì„¸ìš”! ğŸ·ï¸ğŸ’";
                }
            } else if (goblin.name === 'íˆ¬ìê·€ì¬') {
                if (message.includes('íˆ¬ì') || message.includes('ì£¼ì‹') || message.includes('í€ë“œ')) {
                    return "íˆ¬ìì˜ ê¸°ë³¸ì€ ë¶„ì‚°ê³¼ ì¥ê¸°ì  ê´€ì ì…ë‹ˆë‹¤! ë¦¬ìŠ¤í¬ë¥¼ ê´€ë¦¬í•˜ë©´ì„œ í¬íŠ¸í´ë¦¬ì˜¤ë¥¼ ë‹¤ì–‘í™”í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•´ìš”. ğŸ“ˆğŸ’°";
                } else if (message.includes('ìœ„í—˜') || message.includes('ìˆ˜ìµ') || message.includes('ë¶„ì„')) {
                    return "ê³ ìˆ˜ìµ ë’¤ì—ëŠ” í•­ìƒ ê³ ìœ„í—˜ì´ ìˆìŠµë‹ˆë‹¤. í€ë”ë©˜í„¸ ë¶„ì„ê³¼ ê¸°ìˆ ì  ë¶„ì„ì„ ë³‘í–‰í•˜ì—¬ ì‹ ì¤‘í•˜ê²Œ íˆ¬ìí•˜ì„¸ìš”! âš–ï¸ğŸ”";
                } else if (message.includes('ë¶€ë™ì‚°') || message.includes('ê²½ì œ')) {
                    return "ë¶€ë™ì‚°ì€ ì¸í”Œë ˆì´ì…˜ í—¤ì§€ ìˆ˜ë‹¨ì…ë‹ˆë‹¤. ìœ„ì¹˜, êµí†µ, ê°œë°œ ê³„íšì„ ì¢…í•©ì ìœ¼ë¡œ ê³ ë ¤í•˜ì—¬ íˆ¬ìí•˜ì„¸ìš”! ğŸ˜ï¸ğŸ“Š";
                }
            } else if (goblin.name === 'ì°½ì—…ë©˜í† ') {
                if (message.includes('ì°½ì—…') || message.includes('ìŠ¤íƒ€íŠ¸ì—…') || message.includes('ì‚¬ì—…')) {
                    return "ì°½ì—…ì€ ë¬¸ì œë¥¼ í•´ê²°í•˜ëŠ” ì—¬ì •ì…ë‹ˆë‹¤! ê³ ê°ì˜ ì§„ì§œ ë¬¸ì œë¥¼ ì°¾ê³ , MVPë¡œ ë¹ ë¥´ê²Œ ê²€ì¦í•´ë³´ì„¸ìš”. ì‹¤íŒ¨ë¥¼ ë‘ë ¤ì›Œí•˜ì§€ ë§ˆì„¸ìš”! ğŸš€ğŸ’ª";
                } else if (message.includes('ì•„ì´ë””ì–´') || message.includes('ë¹„ì¦ˆë‹ˆìŠ¤ëª¨ë¸')) {
                    return "ì¢‹ì€ ì•„ì´ë””ì–´ë³´ë‹¤ ì‹¤í–‰ë ¥ì´ ì¤‘ìš”í•©ë‹ˆë‹¤. ë¦° ìŠ¤íƒ€íŠ¸ì—… ë°©ë²•ë¡ ìœ¼ë¡œ ë¹ ë¥´ê²Œ ì‹œì¥ì— ì¶œì‹œí•˜ê³  í”¼ë“œë°±ì„ ë°›ì•„ë³´ì„¸ìš”! ğŸ’¡âš¡";
                } else if (message.includes('ìê¸ˆ') || message.includes('íˆ¬ììœ ì¹˜')) {
                    return "ìê¸ˆ ì¡°ë‹¬ì€ ë‹¨ê³„ë³„ë¡œ ì ‘ê·¼í•˜ì„¸ìš”. ì—”ì ¤ íˆ¬ìì, VC, í¬ë¼ìš°ë“œí€ë”© ë“± ë‹¤ì–‘í•œ ì˜µì…˜ì„ ê³ ë ¤í•´ë³´ì„¸ìš”! ğŸ’¸ğŸ¯";
                }
            } else if (goblin.name === 'ì„¸ë¬´ì „ë¬¸ê°€') {
                if (message.includes('ì„¸ê¸ˆ') || message.includes('ì„¸ë¬´') || message.includes('ì‹ ê³ ')) {
                    return "ì„¸ë¬´ëŠ” ì‚¬ì—…ì˜ ìƒëª…ì„ ì…ë‹ˆë‹¤! ì •í™•í•œ ì„¸ë¬´ ì‹ ê³ ì™€ ì ˆì„¸ ì „ëµìœ¼ë¡œ ê±´ì „í•œ ì‚¬ì—… ìš´ì˜ì„ ë„ì™€ë“œë¦´ê²Œìš”. ğŸ“‹ğŸ”¢";
                } else if (message.includes('ì ˆì„¸') || message.includes('ê³µì œ') || message.includes('í˜œíƒ')) {
                    return "í•©ë²•ì ì¸ ì ˆì„¸ ë°©ë²•ì€ ë§ìŠµë‹ˆë‹¤. ì—°êµ¬ê°œë°œë¹„, êµìœ¡í›ˆë ¨ë¹„, ê¸°ë¶€ê¸ˆ ë“±ì˜ ê³µì œ í˜œíƒì„ ì ê·¹ í™œìš©í•˜ì„¸ìš”! ğŸ’¡ğŸ“Š";
                } else if (message.includes('ë²•ì¸') || message.includes('ê°œì¸ì‚¬ì—…ì')) {
                    return "ì‚¬ì—… í˜•íƒœì— ë”°ë¼ ì„¸ê¸ˆ êµ¬ì¡°ê°€ ë‹¬ë¼ì§‘ë‹ˆë‹¤. ë²•ì¸ê³¼ ê°œì¸ì‚¬ì—…ìì˜ ì¥ë‹¨ì ì„ ë¹„êµí•´ì„œ ìµœì ì˜ ì„ íƒì„ í•˜ì„¸ìš”! âš–ï¸ğŸ¢";
                }
            } else if (goblin.name === 'HRì „ë¬¸ê°€') {
                if (message.includes('ì¸ì‚¬') || message.includes('ì±„ìš©') || message.includes('ì¸ì¬')) {
                    return "í›Œë¥­í•œ ì¸ì¬ëŠ” íšŒì‚¬ì˜ ìì‚°ì…ë‹ˆë‹¤! ì—­ëŸ‰ ê¸°ë°˜ ì±„ìš©ê³¼ ì²´ê³„ì ì¸ êµìœ¡ìœ¼ë¡œ ìµœê³ ì˜ íŒ€ì„ ë§Œë“¤ì–´ë³´ì„¸ìš”. ğŸ‘¥â­";
                } else if (message.includes('ë¬¸í™”') || message.includes('ë³µì§€') || message.includes('ë™ê¸°ë¶€ì—¬')) {
                    return "ê¸°ì—… ë¬¸í™”ëŠ” ì„±ê³¼ì˜ ê¸°ë°˜ì…ë‹ˆë‹¤. ì†Œí†µê³¼ ì‹ ë¢°ë¥¼ ë°”íƒ•ìœ¼ë¡œ í•œ ì¡°ì§ ë¬¸í™”ê°€ ì§ì›ë“¤ì˜ ì°½ì˜ì„±ì„ ë°œíœ˜ì‹œì¼œìš”! ğŸŒŸğŸ’«";
                } else if (message.includes('ì„±ê³¼') || message.includes('í‰ê°€') || message.includes('êµìœ¡')) {
                    return "ê³µì •í•œ ì„±ê³¼ í‰ê°€ì™€ ì§€ì†ì ì¸ êµìœ¡ì´ ì¡°ì§ ë°œì „ì˜ í•µì‹¬ì…ë‹ˆë‹¤. ê°œì¸ì˜ ì„±ì¥ì´ ê³§ íšŒì‚¬ì˜ ì„±ì¥ì´ì—ìš”! ğŸ“ˆğŸ“";
                }
            }
            
            // ì¼ë°˜ì ì¸ ë¹„ì¦ˆë‹ˆìŠ¤ ì‘ë‹µ
            const generalResponses = [
                `${goblin.name}ì´ ${goblin.description.slice(0, 50)}... ë” ìì„¸íˆ ì•Œê³  ì‹¶ì€ ê²ƒì´ ìˆìœ¼ì‹ ê°€ìš”? ğŸ¢âœ¨`,
                "ì„±ê³µì ì¸ ë¹„ì¦ˆë‹ˆìŠ¤ëŠ” ê³ ê° ê°€ì¹˜ ì°½ì¶œì—ì„œ ì‹œì‘ë©ë‹ˆë‹¤. í•¨ê»˜ ì „ëµì„ ì„¸ì›Œë´…ì‹œë‹¤! ğŸ’¼ğŸ¯",
                "ë³€í™”í•˜ëŠ” ì‹œì¥ì—ì„œ ì‚´ì•„ë‚¨ìœ¼ë ¤ë©´ í˜ì‹ ì´ í•„ìš”í•©ë‹ˆë‹¤. ì–´ë–¤ ë¶„ì•¼ì— ê´€ì‹¬ì´ ìˆìœ¼ì‹ ê°€ìš”? ğŸš€ğŸ’¡",
                "ë¹„ì¦ˆë‹ˆìŠ¤ëŠ” ì‚¬ëŒê³¼ ì‚¬ëŒì˜ ê´€ê³„ì…ë‹ˆë‹¤. ì‹ ë¢°ë¥¼ ë°”íƒ•ìœ¼ë¡œ íŒŒíŠ¸ë„ˆì‹­ì„ êµ¬ì¶•í•´ë´…ì‹œë‹¤! ğŸ¤ğŸ’",
                "ë°ì´í„° ê¸°ë°˜ ì˜ì‚¬ê²°ì •ì´ í˜„ëŒ€ ë¹„ì¦ˆë‹ˆìŠ¤ì˜ í•µì‹¬ì…ë‹ˆë‹¤. í•¨ê»˜ ë¶„ì„í•´ë´…ì‹œë‹¤! ğŸ“ŠğŸ”"
            ];
            
            return generalResponses[Math.floor(Math.random() * generalResponses.length)];
        }
        
        // ğŸ¢ ë¹„ì¦ˆë‹ˆìŠ¤ í™˜ê²½ ìƒì„±
        function createBusinessEnvironment() {
            // ğŸ¢ ê³ ì¸µ ë¹Œë”©ë“¤
            for (let i = 0; i < 20; i++) {
                createSkyscraper();
            }
            
            // ğŸš— ë¹„ì¦ˆë‹ˆìŠ¤ ì¹´ë“¤
            for (let i = 0; i < 10; i++) {
                createBusinessCar();
            }
            
            // ğŸ’¡ ë„¤ì˜¨ ì‚¬ì¸ë“¤
            for (let i = 0; i < 15; i++) {
                createNeonSign();
            }
            
            // ğŸŒƒ ë„ì‹œ ì¡°ëª…
            createCityLighting();
        }
        
        // ğŸ¢ ê³ ì¸µ ë¹Œë”© ìƒì„±
        function createSkyscraper() {
            const buildingGroup = new THREE.Group();
            
            const height = 15 + Math.random() * 25;
            const width = 3 + Math.random() * 2;
            const depth = 3 + Math.random() * 2;
            
            const buildingGeometry = new THREE.BoxGeometry(width, height, depth);
            const buildingColors = [0x2c3e50, 0x34495e, 0x5d6d7e, 0x85929e];
            const buildingColor = buildingColors[Math.floor(Math.random() * buildingColors.length)];
            const buildingMaterial = new THREE.MeshPhongMaterial({ color: buildingColor });
            const building = new THREE.Mesh(buildingGeometry, buildingMaterial);
            building.position.y = height / 2;
            buildingGroup.add(building);
            
            // ì°½ë¬¸ë“¤
            for (let floor = 0; floor < height / 3; floor++) {
                for (let window = 0; window < 3; window++) {
                    const windowGeometry = new THREE.PlaneGeometry(0.3, 0.3);
                    const windowMaterial = new THREE.MeshBasicMaterial({ 
                        color: Math.random() > 0.7 ? 0xffff99 : 0x333333,
                        transparent: true,
                        opacity: 0.8
                    });
                    const windowMesh = new THREE.Mesh(windowGeometry, windowMaterial);
                    windowMesh.position.set(
                        -width/2 + 0.5 + window * 0.8,
                        1 + floor * 3,
                        depth/2 + 0.01
                    );
                    buildingGroup.add(windowMesh);
                }
            }
            
            const x = (Math.random() - 0.5) * 80;
            const z = (Math.random() - 0.5) * 80;
            buildingGroup.position.set(x, 0, z);
            
            scene.add(buildingGroup);
        }
        
        // ğŸš— ë¹„ì¦ˆë‹ˆìŠ¤ ì¹´ ìƒì„±
        function createBusinessCar() {
            const carGroup = new THREE.Group();
            
            const carBody = new THREE.BoxGeometry(4, 1, 2);
            const carMaterial = new THREE.MeshPhongMaterial({ color: 0x2c3e50 });
            const car = new THREE.Mesh(carBody, carMaterial);
            car.position.y = 0.5;
            carGroup.add(car);
            
            // ë°”í€´ë“¤
            const wheelGeometry = new THREE.CylinderGeometry(0.3, 0.3, 0.2);
            const wheelMaterial = new THREE.MeshPhongMaterial({ color: 0x000000 });
            
            const positions = [[-1.5, 0, -0.8], [1.5, 0, -0.8], [-1.5, 0, 0.8], [1.5, 0, 0.8]];
            positions.forEach(pos => {
                const wheel = new THREE.Mesh(wheelGeometry, wheelMaterial);
                wheel.rotation.z = Math.PI / 2;
                wheel.position.set(pos[0], pos[1], pos[2]);
                carGroup.add(wheel);
            });
            
            const x = (Math.random() - 0.5) * 60;
            const z = (Math.random() - 0.5) * 60;
            carGroup.position.set(x, 0, z);
            
            scene.add(carGroup);
        }
        
        // ğŸ’¡ ë„¤ì˜¨ ì‚¬ì¸ ìƒì„±
        function createNeonSign() {
            const signGeometry = new THREE.PlaneGeometry(4, 2);
            const neonColors = [0x3498db, 0xe74c3c, 0xf39c12, 0x2ecc71];
            const signColor = neonColors[Math.floor(Math.random() * neonColors.length)];
            const signMaterial = new THREE.MeshBasicMaterial({ 
                color: signColor,
                transparent: true,
                opacity: 0.8
            });
            const sign = new THREE.Mesh(signGeometry, signMaterial);
            
            const x = (Math.random() - 0.5) * 70;
            const y = 5 + Math.random() * 10;
            const z = (Math.random() - 0.5) * 70;
            sign.position.set(x, y, z);
            
            // ê¹œë¹¡ì´ëŠ” íš¨ê³¼
            gsap.to(sign.material, {
                opacity: 0.3,
                duration: 1 + Math.random(),
                repeat: -1,
                yoyo: true,
                ease: "sine.inOut"
            });
            
            scene.add(sign);
        }
        
        // ğŸŒƒ ë„ì‹œ ì¡°ëª…
        function createCityLighting() {
            const ambientLight = new THREE.AmbientLight(0x404040, 0.4);
            scene.add(ambientLight);
            
            const directionalLight = new THREE.DirectionalLight(0x3498db, 0.8);
            directionalLight.position.set(10, 20, 10);
            directionalLight.castShadow = true;
            scene.add(directionalLight);
            
            // ë„¤ì˜¨ ì¡°ëª…ë“¤
            for (let i = 0; i < 5; i++) {
                const neonLight = new THREE.PointLight(0x3498db, 1, 20);
                neonLight.position.set(
                    (Math.random() - 0.5) * 40,
                    5 + Math.random() * 10,
                    (Math.random() - 0.5) * 40
                );
                scene.add(neonLight);
            }
        }
        
        // ğŸ¢ ë¹„ì¦ˆë‹ˆìŠ¤ êµ¬ì—­ ì´ˆê¸°í™”
        function initBusinessDistrict() {
            console.log('ğŸ¢ ë¹„ì¦ˆë‹ˆìŠ¤ êµ¬ì—­ ì´ˆê¸°í™” ì‹œì‘...');
            
            scene = new THREE.Scene();
            scene.background = new THREE.Color(0x1a1a2e);
            
            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.set(0, 15, 25);
            
            const canvas = document.getElementById('business-canvas');
            renderer = new THREE.WebGLRenderer({ canvas: canvas, antialias: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.shadowMap.enabled = true;
            renderer.shadowMap.type = THREE.PCFSoftShadowMap;
            
            controls = new THREE.OrbitControls(camera, renderer.domElement);
            controls.enableDamping = true;
            controls.dampingFactor = 0.05;
            
            // ğŸ¢ ë¹„ì¦ˆë‹ˆìŠ¤ í™˜ê²½ ìƒì„±
            createBusinessEnvironment();
            
            // ğŸ’¼ 3D ë¹„ì¦ˆë‹ˆìŠ¤ ë„ê¹¨ë¹„ë“¤ ìƒì„±
            createBusiness3DGoblins();
            
            // ğŸ’¼ ë¹„ì¦ˆë‹ˆìŠ¤ ë„ê¹¨ë¹„ ì¹´ë“œ ìƒì„±
            createBusinessGoblinCards();
            
            // ğŸ–±ï¸ ìº”ë²„ìŠ¤ í´ë¦­ ì´ë²¤íŠ¸ ì¶”ê°€
            canvas.addEventListener('click', onBusinessCanvasClick);
            
            isSystemReady = true;
            updateStatus('ğŸ¢ ë¹„ì¦ˆë‹ˆìŠ¤ êµ¬ì—­ì´ ì™„ì„±ë˜ì—ˆìŠµë‹ˆë‹¤! ì„±ê³µì ì¸ ë¹„ì¦ˆë‹ˆìŠ¤ë¥¼ ì‹œì‘í•˜ì„¸ìš”!');
            
            animate();
        }
        
        // ğŸ¬ ì• ë‹ˆë©”ì´ì…˜ ë£¨í”„
        function animate() {
            requestAnimationFrame(animate);
            
            if (controls) {
                controls.update();
            }
            
            if (avatar && controls) {
                controls.target.copy(avatar.position);
                controls.target.y += 1;
            }
            
            // ğŸ·ï¸ ëª¨ë“  ì´ë¦„í‘œë“¤ì´ ì¹´ë©”ë¼ë¥¼ ë°”ë¼ë³´ë„ë¡ ì—…ë°ì´íŠ¸
            scene.traverse((object) => {
                if (object.userData && object.userData.isNameTag && camera) {
                    object.lookAt(camera.position);
                }
            });
            
            if (renderer && scene && camera) {
                renderer.render(scene, camera);
            }
        }
        
        // ğŸ“± ìœˆë„ìš° ë¦¬ì‚¬ì´ì¦ˆ ì²˜ë¦¬
        window.addEventListener('resize', () => {
            if (camera && renderer) {
                camera.aspect = window.innerWidth / window.innerHeight;
                camera.updateProjectionMatrix();
                renderer.setSize(window.innerWidth, window.innerHeight);
            }
        });
        
        // ğŸš€ ë¹„ì¦ˆë‹ˆìŠ¤ êµ¬ì—­ ì‹œì‘
        window.addEventListener('load', () => {
            initBusinessDistrict();
        });
    </script>
</body>
</html>
